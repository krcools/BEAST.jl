<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solving the Time Domain EFIE using Marching-on-in-Time · BEAST Documentation</title><meta name="title" content="Solving the Time Domain EFIE using Marching-on-in-Time · BEAST Documentation"/><meta property="og:title" content="Solving the Time Domain EFIE using Marching-on-in-Time · BEAST Documentation"/><meta property="twitter:title" content="Solving the Time Domain EFIE using Marching-on-in-Time · BEAST Documentation"/><meta name="description" content="Documentation for BEAST Documentation."/><meta property="og:description" content="Documentation for BEAST Documentation."/><meta property="twitter:description" content="Documentation for BEAST Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BEAST Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">BEAST.jl documentation</a></li><li><a class="tocitem" href="../assemble/">The Matrix Assemble Routine</a></li><li><a class="tocitem" href="../assets/postproc/">Post-processing and Visualisation</a></li><li><a class="tocitem" href="../quadstrat/">Quadrature strategies</a></li><li class="is-active"><a class="tocitem" href>Solving the Time Domain EFIE using Marching-on-in-Time</a><ul class="internal"><li><a class="tocitem" href="#Building-the-geometry"><span>Building the geometry</span></a></li></ul></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Solving the Time Domain EFIE using Marching-on-in-Time</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solving the Time Domain EFIE using Marching-on-in-Time</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krcools/BEAST.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krcools/BEAST.jl/blob/master/docs/src/tdefie.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time"><a class="docs-heading-anchor" href="#Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time">Solving the Time Domain EFIE using Marching-on-in-Time</a><a id="Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time" title="Permalink"></a></h1><p>If broadband information is required or if the system under study will be coupled to non-linear components, the scattering problem should be solved directly in the time domain, i.e. as a hyperbolic evolution problem.</p><h2 id="Building-the-geometry"><a class="docs-heading-anchor" href="#Building-the-geometry">Building the geometry</a><a id="Building-the-geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-geometry" title="Permalink"></a></h2><p>Building the geometry and defining the spatial finite elements happens in completely the same manner as for frequency domain simulations:</p><pre><code class="language-julia hljs">using CompScienceMeshes
using BEAST
D, dx = 1.0, 0.3
Γ = meshsphere(1.0, dx)
X = raviartthomas(Γ)
nothing # hide</code></pre><p>Time domain currents are approximated in the tensor product of a spatial and temporal finite element space:</p><p class="math-container">\[j(x) \approx \sum_{i=1}^{N_T} \sum_{m=1}^{N_S} u_{i,m} T_i(t) f_m(x)\]</p><p>This package only supports translation invariant temopral basis functions, i.e.</p><p class="math-container">\[T_i(t) = T(t - i \Delta t),\]</p><p>where <span>$\Delta t$</span> is the time step used to solve the problem. This time step depends on the bandwidth of the incident field and the desired accuracy. Space-Time Galerkin solvers of the type used here are not subject to stability conditions linking spatial and temporal discretisation resolutions.</p><p>We need a temporal trial space and test space. Common examples of temporal trial spaces are the shifted quadratic spline and shifted lagrange basis functions. In this example, a shifted quadratic spline <code>S</code> is used for the trial space, while a delta function <code>U</code> is used as the temporal test space to obtain a time-stepping solution.  </p><pre><code class="language-julia hljs">Δt, Nt = 0.25, 300
S = BEAST.timebasisspline2(Δt, Nt)
U = BEAST.timebasisdelta(Δt, Nt)
nothing # hide</code></pre><p>We want to solve the EFIE, i.e. we want to find the current <span>$j$</span> such that</p><p class="math-container">\[Tj = -e^i,\]</p><p>where the incident electric field can be any Maxwell solution in the background medium. To describe this problem in Julia we create a retarded potential operator objects and a functional representing the incident field:</p><pre><code class="language-julia hljs">x = point(1.0,0.0,0.0)
y = point(0.0,1.0,0.0)
z = point(0.0,0.0,1.0)
gaussian = BEAST.creategaussian(30Δt, 60Δt)
E = BEAST.planewave(x, z, BEAST.derive(gaussian), 1.0)
T = BEAST.MWSingleLayerTDIO(1.0,-1.0,-1.0,2,0)
nothing; # hide</code></pre><p>Using the finite element spaces defined above this retarded potential equation can be discretized.</p><pre><code class="language-julia hljs">V = X ⊗ S #Space and time trial basis
W = X ⊗ U #Space and time test basis

B = assemble(E, W)
Z = assemble(T, W, V)
nothing # hide</code></pre><p>The variable <code>Z</code> can efficiently store the matrices corresponding to different delays (<code>assemble</code> knows about the specific sparsity pattern of such matrices and returns a sparse array of rank three fit for purpose).</p><p>The algorithm below solves the discrete convolution problem by marching on in time:</p><pre><code class="language-julia hljs">Z0 = Z[:,:,1]
W0 = inv(Z0)
x = BEAST.marchonintime(W0,Z,-B,Nt)
nothing # hide</code></pre><p>Computing the values of the induced current is now possible in the same manner as for frequency domain simulations by first converting our MOT solution back to the frequency domain using the fourier transform, along with some adjustments.</p><pre><code class="language-julia hljs">Xefie, Δω, ω0 = fouriertransform(x, Δt, 0.0, 2)
ω = collect(ω0 + (0:Nt-1)*Δω)
_, i1 = findmin(abs(ω-1.0))
ω1 = ω[i1]

ue = Xefie[:,i1]
ue /= fouriertransform(gaussian)(ω1)
fcr, geo = facecurrents(ue, X)
nothing # hide</code></pre><p>For now the package still relies upon Matlab for some of its visualisation. This dependency will be removed in the near future:</p><pre><code class="language-julia hljs">include(Pkg.dir(&quot;CompScienceMeshes&quot;,&quot;examples&quot;,&quot;matlab_patches.jl&quot;))
mat&quot;clf&quot;
patch(geo, real.(norm.(fcr)))
mat&quot;cd($(pwd()))&quot;
mat&quot;print(&#39;current.png&#39;, &#39;-dpng&#39;)&quot;</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quadstrat/">« Quadrature strategies</a><a class="docs-footer-nextpage" href="../tutorial/">Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 9 September 2024 14:29">Monday 9 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
