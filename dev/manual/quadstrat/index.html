<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Setting the Quadrature Strategy Â· BEAST.jl</title><meta name="title" content="Setting the Quadrature Strategy Â· BEAST.jl"/><meta property="og:title" content="Setting the Quadrature Strategy Â· BEAST.jl"/><meta property="twitter:title" content="Setting the Quadrature Strategy Â· BEAST.jl"/><meta name="description" content="Documentation for BEAST.jl."/><meta property="og:description" content="Documentation for BEAST.jl."/><meta property="twitter:description" content="Documentation for BEAST.jl."/><meta property="og:url" content="https://krcools.github.io/BEAST.jl/manual/quadstrat/"/><meta property="twitter:url" content="https://krcools.github.io/BEAST.jl/manual/quadstrat/"/><link rel="canonical" href="https://krcools.github.io/BEAST.jl/manual/quadstrat/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="BEAST.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="BEAST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BEAST.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../usage/">General Usage</a></li><li><a class="tocitem" href="../customexc/">Custom excitations</a></li><li class="is-active"><a class="tocitem" href>Setting the Quadrature Strategy</a><ul class="internal"><li><a class="tocitem" href="#List-of-implemented-quadrature-strategies"><span>List of implemented quadrature strategies</span></a></li><li><a class="tocitem" href="#Explicitly-providing-the-quadrature-strategy"><span>Explicitly providing the quadrature strategy</span></a></li><li><a class="tocitem" href="#Setting-the-default-quadrature-rule"><span>Setting the default quadrature rule</span></a></li><li class="toplevel"><a class="tocitem" href="#Specifying-a-quadrature-strategy-selection-method"><span>Specifying a quadrature strategy selection method</span></a></li></ul></li><li><a class="tocitem" href="../quadrule/">Custom Quadrature Rules</a></li><li><a class="tocitem" href="../customop/">Custom Operators</a></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Application Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-6-1" type="checkbox"/><label class="tocitem" for="menuitem-2-6-1"><span class="docs-label">Time-Harmonic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examplesTH/efie/">EFIE</a></li><li><a class="tocitem" href="../examplesTH/mfie/">MFIE</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6-2" type="checkbox"/><label class="tocitem" for="menuitem-2-6-2"><span class="docs-label">Time-Domain</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examplesTD/tdefie/">EFIE</a></li></ul></li></ul></li><li><a class="tocitem" href="../bilinear/">System of Equations and Bilinear Forms</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/efie/">EFIE</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Operators &amp; Excitations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../operators/overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Local Operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../operators/identity/">Identiy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Boundary Integral Operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../operators/helmholtz/">Helmholtz</a></li><li><input class="collapse-toggle" id="menuitem-4-3-2" type="checkbox"/><label class="tocitem" for="menuitem-4-3-2"><span class="docs-label">Maxwell Single Layer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../operators/maxwellsinglelayer/">Time Harmonic</a></li><li><a class="tocitem" href="../../operators/maxwellsinglelayer_td/">Time Domain</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3-3"><span class="docs-label">Maxwell Double Layer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../operators/maxwelldoublelayer/">Time Harmonic</a></li><li><a class="tocitem" href="../../operators/maxwelldoublelayer_td/">Time Domain</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Volume Integral Operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../operators/maxwellsinglelayerVIE/">Maxwell Single Layer</a></li><li><span class="tocitem">Maxwell Double Layer</span></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Excitations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../excitations/planewave/">Plane Wave</a></li><li><a class="tocitem" href="../../excitations/dipole/">Dipole</a></li><li><a class="tocitem" href="../../excitations/monopole/">Monopole</a></li><li><a class="tocitem" href="../../excitations/linearpotential/">Linear Potential</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Composed Operator</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../composedoperator/composedoperator/">Composed Operator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Quasi Helmholtz Projectors</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../projectors/pmchwt_lf/">Low Frequency Stable PMCHWT</a></li><li><a class="tocitem" href="../../projectors/pmchwt_theta/">Dense Grid Stable PMCHWT</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basis Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../bases/overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Spatial</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../bases/raviartthomas/">Raviart Thomas</a></li><li><a class="tocitem" href="../../bases/buffachristiansen/">Buffa Christiansen</a></li><li><a class="tocitem" href="../../bases/brezzidouglasmarini/">Brezzi-Douglas-Marini</a></li><li><a class="tocitem" href="../../bases/gragliawiltonpeterson/">Graglia-Wilton-Peterson</a></li></ul></li><li><span class="tocitem">Temporal</span></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Geometry Representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../geometry/flat/">Flat</a></li><li><span class="tocitem">Curvilinear</span></li></ul></li><li><span class="tocitem">____________________________________</span></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../internals/overview/">Overview</a></li><li><a class="tocitem" href="../../internals/assemble/">The Matrix Assemble Routine</a></li><li><a class="tocitem" href="../../internals/quadstrat/">Quadrature</a></li><li><span class="tocitem">Parametric Domain</span></li><li><span class="tocitem">Multithreading</span></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">References</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../references/">References</a></li></ul></li><li><a class="tocitem" href="../../apiref/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Setting the Quadrature Strategy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Setting the Quadrature Strategy</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krcools/BEAST.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krcools/BEAST.jl/blob/master/docs/src/manual/quadstrat.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Customising-the-choice-of-quadrature-rules"><a class="docs-heading-anchor" href="#Customising-the-choice-of-quadrature-rules">Customising the choice of quadrature rules</a><a id="Customising-the-choice-of-quadrature-rules-1"></a><a class="docs-heading-anchor-permalink" href="#Customising-the-choice-of-quadrature-rules" title="Permalink"></a></h1><p>At the heart of any boundary element code are routines that can compute matrix entries that take on the form of double integrals over pairs of panels of an integrand that is the product of a test function, a trial function, and the fundamental solution of the equation under study. The fundamental solution is singular at the origin, implying that simple quadrature methods are not sufficient to compute the entries to satisfactory accuracy. A mechanism to activate the most appropriate rule is required. BEAST.jl attempts to offer a reasonable default, but the advanced user may wish to take control beyond this.</p><p>This page describes how the user can intervene in this system.</p><h2 id="List-of-implemented-quadrature-strategies"><a class="docs-heading-anchor" href="#List-of-implemented-quadrature-strategies">List of implemented quadrature strategies</a><a id="List-of-implemented-quadrature-strategies-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-implemented-quadrature-strategies" title="Permalink"></a></h2><p>In BEAST, a clear distinction is made between a <strong>quadrature rule</strong>, which is a numerical algorithm that computes approximate values of a given integral with a given domain (a pair of panels in the case of BEM) and a given integral (comprising testing functions, trial functions, and a fundamental solution in the case of BEM). Different integrands and domains call for different quadrature rules. For a fixed integrand structure, the algorithm that chooses for any given constellation of panels the most appropriate rule is called the <strong>quadrature strategy</strong>.</p><p>The algorithm that determines which quadrature rule is used for any given geometric constellation of interacting panels is called the quadrature strategy. The list of strategies currently implemented in BEAST is:</p><pre><code class="language-julia hljs">using TypeTree
using BEAST

print(join(tt(BEAST.AbstractQuadStrat), &quot;&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BEAST.AbstractQuadStrat
 â”œâ”€ BEAST.CommonFaceOverlappingEdgeQStrat
 â”œâ”€ BEAST.CommonFaceVertexSauterCommonEdgeWiltonPostitiveDistanceNumQStrat
 â”œâ”€ BEAST.DoubleNumQStrat
 â”œâ”€ BEAST.DoubleNumSauterQstrat
 â”œâ”€ BEAST.DoubleNumWiltonBogaertQStrat
 â”œâ”€ BEAST.DoubleNumWiltonSauterQStrat
 â”œâ”€ BEAST.NonConfTestBaryRefOfTrialQStrat
 â”œâ”€ BEAST.NonConformingIntegralOpQStrat
 â”œâ”€ BEAST.NothingQStrategy
 â”œâ”€ BEAST.NumSpaceNumTimeQStrat
 â”œâ”€ BEAST.OuterNumInnerAnalyticQStrat
 â”œâ”€ BEAST.SauterSchwab3DQStrat
 â”œâ”€ BEAST.SelfSauterOtherwiseDNumQStrat
 â”œâ”€ BEAST.SingleNumQStrat
 â”œâ”€ BEAST.TestRefinesTrialQStrat
 â””â”€ BEAST.TrialRefinesTestQStrat</code></pre><p>The type of the quadrature strategy object determines the quadrature rule selection algorithm. The value of the fields contained by the quadrature strategy object typically selects the order or number of quadrature points used by the various possible quadrature rules.</p><p>The methods responsible for caching quadrature related data and quadrature rule selection are named <code>quaddata</code> and <code>quadrule</code>, respectively. For a given combination of a discrete boundary integral operator and quadrature strategy, the methods that will be dispatched to can be queried as follows:</p><pre><code class="language-julia hljs">using CompScienceMeshes
using BEAST

Î“  = meshsphere(radius=1.0, h=0.45) # triangulate sphere of radius one
RT = raviartthomas(Î“)
ğ‘‡ = Maxwell3D.singlelayer(wavenumber=2.0)
qs = BEAST.DoubleNumWiltonSauterQStrat(6, 7, 7, 8, 6, 6, 6, 6)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BEAST.DoubleNumWiltonSauterQStrat{Int64, Int64}(6, 7, 7, 8, 6, 6, 6, 6)</code></pre><pre><code class="language-julia hljs">BEAST.quadinfo(ğ‘‡, RT, RT; quadstrat=qs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">quadstrat = BEAST.DoubleNumWiltonSauterQStrat{Int64, Int64}(6, 7, 7, 8, 6, 6, 6, 6)
quaddata(op::BEAST.IntegralOperator, test_local_space, trial_local_space, test_charts, trial_charts, qs::BEAST.DoubleNumWiltonSauterQStrat) @ BEAST ~/work/BEAST.jl/BEAST.jl/src/quadrature/doublenumwiltonsauterqstrat.jl:12
quadrule(op::BEAST.IntegralOperator, g, f, i, Ï„, j, Ïƒ, qd, qs::BEAST.DoubleNumWiltonSauterQStrat) @ BEAST ~/work/BEAST.jl/BEAST.jl/src/quadrature/doublenumwiltonsauterqstrat.jl:32</code></pre><h2 id="Explicitly-providing-the-quadrature-strategy"><a class="docs-heading-anchor" href="#Explicitly-providing-the-quadrature-strategy">Explicitly providing the quadrature strategy</a><a id="Explicitly-providing-the-quadrature-strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Explicitly-providing-the-quadrature-strategy" title="Permalink"></a></h2><p>The assembly function takes a keyword argument that allows to specify a specific quadrature strategy to use.</p><pre><code class="language-julia hljs">using CompScienceMeshes
using BEAST

Î“  = meshsphere(radius=1.0, h=0.45)   # triangulate sphere of radius one
RT = raviartthomas(Î“)
ğ‘‡ = Maxwell3D.singlelayer(wavenumber=2.0)

Z1 = assemble(ğ‘‡, RT, RT; quadstrat=BEAST.DoubleNumWiltonSauterQStrat(2, 3, 6, 7, 5, 5, 5, 5))
Z2 = assemble(ğ‘‡, RT, RT; quadstrat=BEAST.DoubleNumWiltonSauterQStrat(6, 7, 7, 8, 6, 6, 6, 6))

using LinearAlgebra
2 * norm(Z1-Z2) / norm(Z1+Z2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.000638093802141217</code></pre><p>This method works well when only a single integral operator appears in the boundary integral equation. For systems containing multiple equations or when linear combinations of different operators appear, specifying a single quadrature strategy at the callsite of <code>assemble</code> will likely not be appropriate.</p><h2 id="Setting-the-default-quadrature-rule"><a class="docs-heading-anchor" href="#Setting-the-default-quadrature-rule">Setting the default quadrature rule</a><a id="Setting-the-default-quadrature-rule-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-the-default-quadrature-rule" title="Permalink"></a></h2><p>To query the set default quadrature strategy for a triple <code>(op, testfns, trialfns)</code>,</p><pre><code class="language-julia hljs">using CompScienceMeshes
using BEAST

Î“  = meshsphere(radius=1.0, h=0.45)   # triangulate sphere of radius one
RT = raviartthomas(Î“)
ğ‘‡ = Maxwell3D.singlelayer(wavenumber=2.0)

BEAST.defaultquadstrat(ğ‘‡, RT, RT)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BEAST.DoubleNumWiltonSauterQStrat{Int64, Int64}(2, 3, 6, 7, 5, 5, 4, 3)</code></pre><p>A new default can be set using the <code>@defaultquadstrat</code> macro. This creates a new method for the function <code>defaultquadstrat</code> that will be dispatched to for the arguments of the provided types.</p><pre><code class="language-julia hljs">BEAST.@defaultquadstrat (ğ‘‡, RT, RT) BEAST.DoubleNumWiltonSauterQStrat(6, 7, 7, 8, 6, 6, 6, 6)
Z2 = assemble(ğ‘‡, RT, RT)

BEAST.@defaultquadstrat (ğ‘‡, RT, RT) BEAST.DoubleNumWiltonSauterQStrat(2, 3, 6, 7, 5, 5, 5, 5)
Z1 = assemble(ğ‘‡, RT, RT)

using LinearAlgebra
2 * norm(Z1-Z2) / norm(Z1+Z2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.000638093802141217</code></pre><p>The above number provides some insight into the accuracy of the selected quadrature strategy. The advantage of setting the default quadrature strategy like this is that it is global and will automatically affect all subsequent calls to assembly. This means the set strategy will be used even if assembly is called as part of the assembly of a more complicated larger system, potentially containing linear combinations of integral operators.</p><p>The downside is that the default can only be set for concrete types of <code>(op, testfns, trialfns)</code> and that the call to the macro needs to be at Module scope. This makes it less appealing for complicated simulations and sweeps over the quadrature accuracy.</p><h1 id="Specifying-a-quadrature-strategy-selection-method"><a class="docs-heading-anchor" href="#Specifying-a-quadrature-strategy-selection-method">Specifying a quadrature strategy selection method</a><a id="Specifying-a-quadrature-strategy-selection-method-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-a-quadrature-strategy-selection-method" title="Permalink"></a></h1><p>This method is somehwat more involved, but is the most general and should allow for full control of the quadrature rules used in assembly.</p><pre><code class="language-julia hljs">function myquadstrat1(op, testfns, trialfns)
    if op isa BEAST.MWSingleLayer3D
        return BEAST.DoubleNumWiltonSauterQStrat(2, 3, 6, 7, 5, 5, 5, 5)
    end
    return BEAST.defaultquadstrat(op, testfns, trialfns)
end

function myquadstrat2(op, testfns, trialfns)
    if op isa BEAST.MWSingleLayer3D
        return BEAST.DoubleNumWiltonSauterQStrat(6, 7, 7, 8, 6, 6, 6, 6)
    end
    return BEAST.defaultquadstrat(op, testfns, trialfns)
end


Z1 = assemble(ğ‘‡, RT, RT; quadstrat=myquadstrat1)
Z3 = assemble(ğ‘‡, RT, RT; quadstrat=myquadstrat2)
2 * norm(Z1-Z2) / norm(Z1+Z2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.000638093802141217</code></pre><p>Best practice is too return <code>BEAST.defaultquadstrat(op, testnfs, trialfns)</code> by default to ensure that all operators are supported, also those for which no explicit overwrite is specified.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../customexc/">Â« Custom excitations</a><a class="docs-footer-nextpage" href="../quadrule/">Custom Quadrature Rules Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Saturday 25 October 2025 13:44">Saturday 25 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
