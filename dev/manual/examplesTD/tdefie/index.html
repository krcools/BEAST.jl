<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>EFIE · BEAST.jl</title><meta name="title" content="EFIE · BEAST.jl"/><meta property="og:title" content="EFIE · BEAST.jl"/><meta property="twitter:title" content="EFIE · BEAST.jl"/><meta name="description" content="Documentation for BEAST.jl."/><meta property="og:description" content="Documentation for BEAST.jl."/><meta property="twitter:description" content="Documentation for BEAST.jl."/><meta property="og:url" content="https://krcools.github.io/BEAST.jl/manual/examplesTD/tdefie/"/><meta property="twitter:url" content="https://krcools.github.io/BEAST.jl/manual/examplesTD/tdefie/"/><link rel="canonical" href="https://krcools.github.io/BEAST.jl/manual/examplesTD/tdefie/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="BEAST.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="BEAST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">BEAST.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../usage/">General Usage</a></li><li><a class="tocitem" href="../../customexc/">Custom excitations</a></li><li><a class="tocitem" href="../../quadstrat/">Setting the Quadrature Strategy</a></li><li><a class="tocitem" href="../../quadrule/">Custom Quadrature Rules</a></li><li><a class="tocitem" href="../../customop/">Custom Operators</a></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox" checked/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Application Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-6-1" type="checkbox"/><label class="tocitem" for="menuitem-2-6-1"><span class="docs-label">Time-Harmonic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examplesTH/efie/">EFIE</a></li><li><a class="tocitem" href="../../examplesTH/mfie/">MFIE</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-6-2"><span class="docs-label">Time-Domain</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>EFIE</a></li></ul></li></ul></li><li><a class="tocitem" href="../../bilinear/">System of Equations and Bilinear Forms</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/efie/">EFIE</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Operators &amp; Excitations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../operators/overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Local Operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../operators/identity/">Identiy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Boundary Integral Operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../operators/helmholtz/">Helmholtz</a></li><li><input class="collapse-toggle" id="menuitem-4-3-2" type="checkbox"/><label class="tocitem" for="menuitem-4-3-2"><span class="docs-label">Maxwell Single Layer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../operators/maxwellsinglelayer/">Time Harmonic</a></li><li><a class="tocitem" href="../../../operators/maxwellsinglelayer_td/">Time Domain</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3-3"><span class="docs-label">Maxwell Double Layer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../operators/maxwelldoublelayer/">Time Harmonic</a></li><li><a class="tocitem" href="../../../operators/maxwelldoublelayer_td/">Time Domain</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Volume Integral Operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../operators/maxwellsinglelayerVIE/">Maxwell Single Layer</a></li><li><span class="tocitem">Maxwell Double Layer</span></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Excitations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../excitations/planewave/">Plane Wave</a></li><li><a class="tocitem" href="../../../excitations/dipole/">Dipole</a></li><li><a class="tocitem" href="../../../excitations/monopole/">Monopole</a></li><li><a class="tocitem" href="../../../excitations/linearpotential/">Linear Potential</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basis Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../bases/overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Spatial</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../bases/raviartthomas/">Raviart Thomas</a></li><li><a class="tocitem" href="../../../bases/buffachristiansen/">Buffa Christiansen</a></li><li><a class="tocitem" href="../../../bases/brezzidouglasmarini/">Brezzi-Douglas-Marini</a></li><li><a class="tocitem" href="../../../bases/gragliawiltonpeterson/">Graglia-Wilton-Peterson</a></li></ul></li><li><span class="tocitem">Temporal</span></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Geometry Representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../geometry/flat/">Flat</a></li><li><span class="tocitem">Curvilinear</span></li></ul></li><li><span class="tocitem">____________________________________</span></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../internals/overview/">Overview</a></li><li><a class="tocitem" href="../../../internals/assemble/">The Matrix Assemble Routine</a></li><li><a class="tocitem" href="../../../internals/quadstrat/">Quadrature</a></li><li><span class="tocitem">Parametric Domain</span></li><li><span class="tocitem">Multithreading</span></li></ul></li><li><a class="tocitem" href="../../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../../references/">References</a></li><li><a class="tocitem" href="../../../apiref/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">Application Examples</a></li><li><a class="is-disabled">Time-Domain</a></li><li class="is-active"><a href>EFIE</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>EFIE</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krcools/BEAST.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krcools/BEAST.jl/blob/master/docs/src/manual/examplesTD/tdefie.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time"><a class="docs-heading-anchor" href="#Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time">Solving the Time Domain EFIE using Marching-on-in-Time</a><a id="Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-Time-Domain-EFIE-using-Marching-on-in-Time" title="Permalink"></a></h1><div class="admonition is-warning" id="Warning-dce73c724d4fc0f1"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-dce73c724d4fc0f1" title="Permalink"></a></header><div class="admonition-body"><p>Make the following an @example which is actually executed.</p></div></div><p>If broadband information is required or if the system under study will be coupled to non-linear components, the scattering problem should be solved directly in the time domain, i.e. as a hyperbolic evolution problem.</p><h3 id="Building-the-geometry"><a class="docs-heading-anchor" href="#Building-the-geometry">Building the geometry</a><a id="Building-the-geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-geometry" title="Permalink"></a></h3><p>Building the geometry and defining the spatial finite elements happens in completely the same manner as for frequency domain simulations:</p><pre><code class="language-julia hljs">using CompScienceMeshes
using BEAST
D, dx = 1.0, 0.3
Γ = meshsphere(1.0, dx)
X = raviartthomas(Γ)
nothing # hide</code></pre><h3 id="Basis-functions"><a class="docs-heading-anchor" href="#Basis-functions">Basis functions</a><a id="Basis-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Basis-functions" title="Permalink"></a></h3><p>Time domain currents are approximated in the tensor product of a spatial and temporal finite element space:</p><p class="math-container">\[j(x) \approx \sum_{i=1}^{N_T} \sum_{m=1}^{N_S} u_{i,m} T_i(t) f_m(x)\]</p><p>This package only supports translation invariant temopral basis functions, i.e.</p><p class="math-container">\[T_i(t) = T(t - i \Delta t),\]</p><p>where <span>$\Delta t$</span> is the time step used to solve the problem. This time step depends on the bandwidth of the incident field and the desired accuracy. Space-Time Galerkin solvers of the type used here are not subject to stability conditions linking spatial and temporal discretisation resolutions.</p><p>We need a temporal trial space and test space. Common examples of temporal trial spaces are the shifted quadratic spline and shifted lagrange basis functions. In this example, a shifted quadratic spline <code>S</code> is used for the trial space, while a delta function <code>U</code> is used as the temporal test space to obtain a time-stepping solution.  </p><pre><code class="language-julia hljs">Δt, Nt = 0.25, 300
S = BEAST.timebasisspline2(Δt, Nt)
U = BEAST.timebasisdelta(Δt, Nt)
nothing # hide</code></pre><h3 id="Excitation"><a class="docs-heading-anchor" href="#Excitation">Excitation</a><a id="Excitation-1"></a><a class="docs-heading-anchor-permalink" href="#Excitation" title="Permalink"></a></h3><p>We want to solve the EFIE, i.e. we want to find the current <span>$j$</span> such that</p><p class="math-container">\[Tj = -e^i,\]</p><p>where the incident electric field can be any Maxwell solution in the background medium. To describe this problem in Julia we create a retarded potential operator objects and a functional representing the incident field:</p><pre><code class="language-julia hljs">x = point(1.0,0.0,0.0)
y = point(0.0,1.0,0.0)
z = point(0.0,0.0,1.0)
gaussian = BEAST.creategaussian(30Δt, 60Δt)
E = BEAST.planewave(x, z, BEAST.derive(gaussian), 1.0)
T = BEAST.MWSingleLayerTDIO(1.0,-1.0,-1.0,2,0)
nothing; # hide</code></pre><h3 id="Setting-up-the-LSE"><a class="docs-heading-anchor" href="#Setting-up-the-LSE">Setting up the LSE</a><a id="Setting-up-the-LSE-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-up-the-LSE" title="Permalink"></a></h3><p>Using the finite element spaces defined above this retarded potential equation can be discretized.</p><pre><code class="language-julia hljs">V = X ⊗ S #Space and time trial basis
W = X ⊗ U #Space and time test basis

B = assemble(E, W)
Z = assemble(T, W, V)
nothing # hide</code></pre><p>The variable <code>Z</code> can efficiently store the matrices corresponding to different delays (<code>assemble</code> knows about the specific sparsity pattern of such matrices and returns a sparse array of rank three fit for purpose).</p><p>The algorithm below solves the discrete convolution problem by marching on in time:</p><pre><code class="language-julia hljs">Z0 = Z[:,:,1]
W0 = inv(Z0)
x = BEAST.marchonintime(W0,Z,-B,Nt)
nothing # hide</code></pre><h3 id="Post-processing"><a class="docs-heading-anchor" href="#Post-processing">Post processing</a><a id="Post-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Post-processing" title="Permalink"></a></h3><p>Computing the values of the induced current is now possible in the same manner as for frequency domain simulations by first converting our MOT solution back to the frequency domain using the fourier transform, along with some adjustments.</p><pre><code class="language-julia hljs">Xefie, Δω, ω0 = fouriertransform(x, Δt, 0.0, 2)
ω = collect(ω0 + (0:Nt-1)*Δω)
_, i1 = findmin(abs(ω-1.0))
ω1 = ω[i1]

ue = Xefie[:,i1]
ue /= fouriertransform(gaussian)(ω1)
fcr, geo = facecurrents(ue, X)
nothing # hide</code></pre><p>For now the package still relies upon Matlab for some of its visualisation. This dependency will be removed in the near future:</p><pre><code class="language-julia hljs">include(Pkg.dir(&quot;CompScienceMeshes&quot;,&quot;examples&quot;,&quot;matlab_patches.jl&quot;))
mat&quot;clf&quot;
patch(geo, real.(norm.(fcr)))
mat&quot;cd($(pwd()))&quot;
mat&quot;print(&#39;current.png&#39;, &#39;-dpng&#39;)&quot;</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examplesTH/mfie/">« MFIE</a><a class="docs-footer-nextpage" href="../../bilinear/">System of Equations and Bilinear Forms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Monday 16 June 2025 13:46">Monday 16 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
