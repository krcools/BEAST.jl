```@meta
EditURL = "../../../examples/pmchwt_theta.jl"
```

# Higher-order Multiplicative Calderon Preconditioning

We begin with loading the needed packages

````julia
using CompScienceMeshes, BEAST
using LinearAlgebra
using PlotlyJS
````

Then we start with defining the geometry and creating the mesh.

````julia
h=0.5
M = meshsphere(1.0, h; generator=:gmsh);
````

Once the geometry has been created, the basis function space $X$ can be defined on the mesh.
In this example, we use basis functions of order $p=1$. Further, higher-order basis space $Y$ will be needed to build a preconditioner.

````julia
p=1
X = BEAST.gwpdiv(M;order=p)
Y = BEAST.gwpdiv(M;order=p+2);
````

Defintion of material properties

````julia
κ,  η  = 1.0, 1.0
κ′, η′ = √2.0κ, η/√2.0
α, α′ = 1/η, 1/η′;
````

Defintion of integral operators and excitation.

````julia
T = Maxwell3D.singlelayer(wavenumber=κ)
T′ = Maxwell3D.singlelayer(wavenumber=κ′)
K  = Maxwell3D.doublelayer(wavenumber=κ)
K′ = Maxwell3D.doublelayer(wavenumber=κ′)
E = Maxwell3D.planewave(direction=ẑ, polarization=x̂, wavenumber=κ);
H = -1/(im*κ*η)*curl(E)

e = (n × E) × n
h = (n × H) × n;
````

Next, we increase the default number of quadrature points, since higher order basis are used.

````julia
BEAST.@defaultquadstrat (T,X,X) BEAST.DoubleNumSauterQstrat(7,7,6,6,6,6)
BEAST.@defaultquadstrat (K,X,X) BEAST.DoubleNumSauterQstrat(7,7,6,6,6,6)
BEAST.@defaultquadstrat (e,X) BEAST.SingleNumQStrat(10)
BEAST.@defaultquadstrat (h,X) BEAST.SingleNumQStrat(10);
````

Here is the core that allows Calderon preconditioning for a higher order basis, without using dual functions.
The $\Theta$-operators enable mapping a lower-order solenoidal subspace into a higher-order nonsolenoidal subspace and vice-versa.
They are defined like this:
$$ \Theta_\Sigma = P_\Sigma^r N_{rp} P_\Lambda^p $$
$$ \Theta_\Lambda = P_\Lambda^r N_{rp} P_\Sigma^p $$
where PΣ and PΛ are the quasi-Helmholtz projectors, N the mixed Gram matrix of the lower and higher order basis, and the super-/subscripts indicate the order of the basis.

````julia
ΘΣ = BEAST.ThetaStars()
ΘΛ = BEAST.ThetaLoops();
````

With everthing defined and setup, the linear system can be built.

````julia
@hilbertspace j m
@hilbertspace r s;
````

In a first step, the standard PMCHWT system is assembled based on the basis $X$.

````julia
Ah = assemble( (η*T+η′*T′)[r,j] -      (K+K′)[r,m] +
                    (K+K′)[s,j] + (α*T+α′*T′)[s,m], s∈X, r∈X, j∈X, m∈X);
````

Next, we assemble the block diagonal preconditioner using the higher order basis $Y$.

````julia
Ch = assemble(T[r,j]+T[s,m],s∈Y, r∈Y, j∈Y, m∈Y);
````

The $\Theta$-Operator can be assembled like other operators. Mapping from the lowere order basis $X$ to the higher order basis $Y$.

````julia
Θh = assemble( ΘΣ[r,j] + ΘΛ[r,j] + ΘΣ[s,m] + ΘΛ[s,m] ,s∈Y, r∈Y, j∈X, m∈X);
````

And last but not least, the right hand side is assembled too.

````julia
bh = assemble(-e[j]-h[m],j ∈ X, m∈X);
````

After everything has been assembled the linear system can be solved using GMRES.
Once using the higher order preconditioner

````julia
u, stats = solve(BEAST.GMRES(Ah; M=Θh'*Ch*Θh, restart=true, atol=1e-8, rtol=1e-8, verbose=0, memory=50),bh);
````

And without using a preconditioner

````julia
uref, statsref = solve(BEAST.GMRES(Ah; restart=true, atol=1e-8, rtol=1e-8, verbose=0, memory=500),bh);
````

The number of iterations for the preconditioned system:


````
30
````

And the regular system:


````
420
````

Visualizationf of the solution

````julia
fcrj, _ = facecurrents(u[j],X)
fcrm, _ = facecurrents(u[m],X);
````

Plot magnetic surface current

````julia
plt = plot(patch(M, norm.(fcrj)),Layout(title="PMCHWT m"))
````

```@raw html
<div id='dqYmsE1kQh' class='' style=';'></div>
<script type="module">
    import Plotly from "https://esm.sh/plotly.js-dist-min@2.24.2"
    const PLOT = document.getElementById("dqYmsE1kQh")
    const plot_obj = {"data": [{"j":[86,86,83,85,85,78,85,78,78,78,69,74,86,74,74,81,27,71,75,73,73,81,86,86,81,35,43,45,45,43,16,43,36,45,36,36,31,45,45,44,46,46,46,40,40,40,40,35,37,33,42,42,44,44,42,38,38,39,46,46,47,47,44,32,48,48,48,48,49,49,49,49,49,34,47,41,41,79,79,72,82,88,88,82,85,85,88,83,88,80,80,80,88,76,76,77,84,84,70,84,87,84,87,87,87,87,106,106,106,106,106,93,90,105,93,108,108,101,101,96,94,91,104,108,108,108,105,105,105,103,103,94,51,55,66,55,67,67,67,67,67,66,66,65,65,56,66,66,64,64,58,57,56,52,61,61,61,61,50,64,63,63,59,59,59,59,59,64,64,60,62,53,62,62,62,68,68,68,68,68,54,63,63,63,102,102,102,92,98,98,98,98,98,107,107,107,107,107,100,95,100,100,100,89,101,104,100,104,104,104,99,102],"k":[75,69,71,75,83,75,78,3,13,69,14,14,74,15,27,27,4,6,71,71,25,73,73,81,26,26,26,36,43,27,4,36,16,31,31,17,18,37,35,37,37,40,38,31,18,1,38,25,35,25,6,33,33,42,24,7,32,32,39,44,32,39,41,8,9,8,32,47,48,9,2,22,34,23,41,23,24,23,72,22,72,82,77,77,76,77,83,80,80,6,24,79,79,3,12,76,70,82,12,11,84,72,72,22,10,2,21,2,103,93,10,10,11,93,11,105,90,90,12,91,91,5,91,104,101,96,96,94,103,20,94,19,20,20,55,21,21,2,9,65,55,65,56,56,8,7,57,51,58,57,52,52,52,1,51,57,5,19,5,61,60,50,1,18,53,58,52,50,60,53,60,17,16,17,53,62,16,4,28,54,29,54,29,30,28,92,29,29,92,97,91,5,30,15,4,28,102,95,14,14,95,13,89,3,3,101,99,99,89,97,92,99],"intensitymode":"cell","colorscale":"Viridis","intensity":[1.0789781544543333,1.0359754667244312,1.18638770072325,1.1090943904827368,1.1646751488239573,1.0785952189505672,1.1120852150634621,1.0786839929591951,1.0436014461912635,0.9941478904459583,0.9169172490767247,0.8109902282137624,0.8826794628538929,0.6872972596868022,0.5428956114451771,0.6024121657605279,0.48516668383902645,1.216335667440139,1.1453585821830592,1.1548857544786848,1.0668171552042816,0.9532224725108643,0.9329902237883488,0.8621890787019403,0.784231001601842,1.0671659734413412,0.9735362720693163,0.8841942927447664,0.9890000552861101,0.7911685899289491,0.48515210857462854,0.6806598345135432,0.5705811351032488,0.9120105142745358,0.8209249520695182,0.6829999215415825,0.9115001443959232,1.0528024991869558,1.083304264379562,1.1959335439243226,1.1777271949441634,1.1148389934170129,1.1157413597190156,1.0815488232702917,1.0016176161699348,1.0435768486030748,1.0787421911754917,1.1545352519647896,1.1478710943460917,1.21638113817404,1.2159639456604592,1.2326369859009898,1.2217100400048977,1.1746711025309982,1.1540837144408864,1.0455226141851648,1.0173154767151993,1.064349111547306,1.1236337479191174,1.1684612740681233,1.033888333522257,1.0907179364663464,1.1402702946595678,0.9087636502605264,0.6573455261936956,0.8422674097558747,0.8860801735656936,0.8358803984042582,0.696688230170514,0.5995101116756785,0.40058217833819587,0.44723247800957433,0.6808829547960322,0.79006865774572,0.9655062820326696,0.9478498853088078,1.066621093684808,1.066391647669331,0.945883010028735,0.7892454702937469,0.9660914550047809,1.0674653456050816,1.0872050861345177,1.0351003312289566,1.1204044390041226,1.1600951175692389,1.159770884885795,1.2163526912106357,1.1927509894884136,1.2319130484184815,1.2164245730732821,1.150314733620964,1.1447589893089694,1.0455315138515948,1.0168561414416062,1.062912514604478,0.8455191536403245,0.9150180543735548,0.9089976018626184,0.6635452135638648,0.6223075869853226,0.8677950792290852,0.7278107353414628,0.686493372754353,0.4121125560191574,0.45206543702325597,0.36529313666148344,0.3756366364180564,0.5566915284928976,0.616509611695919,0.5609777066003635,0.6399098202036521,0.8852563798511128,0.8220375062181774,0.778187310114571,0.9376197017514593,0.9865124408965863,0.9761412653026934,1.0236208632695287,1.0571936035829106,1.0899921621088318,1.1517808688863727,1.1015097820415785,1.0570327241433561,1.0459176823434095,0.9719124743405065,0.9738535046103846,0.853603568548939,0.7702084909793945,0.6729974398669901,0.848586531483579,0.9801046822104929,0.9811915792514445,0.8486588393877429,0.8528832553553799,0.677239358282855,0.5732472623475973,0.36546361081247897,0.37568492069215026,0.5445227602788341,0.6147647511056974,0.7486159603477868,0.8047433768422462,0.7809995119338516,0.6384462575754551,0.885326319548199,0.9602807865747475,0.9825060904219252,1.0899202680733207,1.103549887642642,1.0547335528516892,0.9917512656387296,0.9677829009056262,1.0237032158587007,1.0592254690018865,1.0743716432326869,1.1689293006414205,1.1525056756447685,1.152513675940997,1.1471006622778874,1.067448810461691,1.0943451841341134,1.0387887720817304,1.0236497604910764,0.9681154878950593,1.0137496158706634,1.0479305087889965,1.0980126380414097,1.0750984817087872,1.0170374153652944,0.8605087124787231,0.8846294808383951,0.6367380136883622,0.831674164965034,0.8575453244136686,0.6342163424687436,0.5620609290002622,0.37456603382715653,0.3643136921004038,0.5869226512683132,0.6779774994832206,0.9182238962827629,0.8619595091558784,0.9803051952160374,0.6751066974614127,0.8947930869412039,0.9007834983479753,0.983447671971559,1.0742446313705285,1.0954463716898666,1.1437730029658042,1.1674206716818483,1.1529475064859307,0.3745541816104735,0.3663471264015906,0.5783333103841094,0.6410760077513935,0.5816803013515138,0.776190167417582,0.6383493275459732,0.8558403028161364,0.8853121934037648,0.9682435335868924,1.0241742081161316,1.0375998531973003,1.050221461008938,0.973239054707174,1.0670784042163262,1.040273976166536,1.1143657363506463,1.025710028716006,0.856372604771792],"z":[0.0,0.0,0.0,0.0,0.0,1.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,0.382683433399756,0.7071067827963323,0.9238795329816334,-0.358090195785944,-0.3356706795464228,-0.923879532419897,-0.5191908058184808,-0.7745103960432691,-0.3798118682651405,-0.7074461341000068,-0.3558187171535342,-0.6323665791883406,-0.3216262457876284,-0.7951427957591927,-0.9602757670306438,-0.5986575723510297,-0.8531172983050641,-0.5948346653831438,-0.6169231499928315,-0.551781317967993,-0.2637779472071395,-0.2458184864106502,0.9238795329815229,0.7559985333325001,0.3356706794744551,0.386219545565487,0.566280939665513,0.5201587399698409,0.3223894901462655,0.6684217588408458,0.5978407437028797,0.3023817416279478,0.7014616384018502,0.9295799197021266,0.2953075384244194,0.8097722402115327,0.8160225317063278,0.2765688812152579,0.5468701425065694,0.2630176920325818,0.2609778624806945,-0.3952076219559407,-0.3356706785514313,-0.923879532419716,-0.5351435445706977,-0.7746503890202773,-0.3820146622154342,-0.677071386133659,-0.3526487901310812,-0.6228902071913645,-0.3216262450197329,-0.7920720943565325,-0.9287622150683578,-0.5418735366387369,-0.6060502965361246,-0.7933212220609549,-0.2967198391184692,-0.574703774067069,-0.5762645909171411,-0.2663484839874635,-0.783263527733557,0.3774855528870367,0.3356706785611195,0.8981968572922676,0.7981217865457602,0.3344008077510922,0.7746503893976326,0.3414808722855108,0.6931325985739222,0.7973925964534126,0.9406675747184216,0.5775432921509455,0.3086592974673492,0.3219345441573563,0.5623828247401734,0.5383335322697146,0.6149623272382255,0.5678011191712297,0.2637861350446407,0.2736594544220287,0.5067051836213782],"cmin":0.3643136921004038,"y":[0.0,0.0,1.0,0.0,-1.0,0.0,0.0,0.382683433399756,0.7071067827963323,0.9238795329816334,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,0.382683433399756,0.7071067827963323,0.9238795329816334,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,-0.5261836318646177,0.5233357175207213,-0.183771065508847,0.7884309811514724,-0.5356371469355471,-0.7818671892093253,-0.3163329681330326,0.1751715966175198,0.2972003337091466,-0.2034408405550134,0.5161949250590815,0.1910107255395768,-0.7290341397978919,0.08759839599731206,-0.5927866929581042,0.001326897186858707,0.607873531887279,0.7936892821447811,0.9376281479749946,-0.1837710644888044,0.5323383182407485,0.1837710655050317,-0.462424128803026,-0.7578760035642076,0.7843488121747915,0.5440420855642704,0.3096909033864427,-0.1011561762507951,-0.1795770589359189,-0.4173250608048786,0.2150136203552799,-0.7723464300332932,-0.517923443025278,-0.02857822919119268,0.7958651123208982,0.6089374927558256,0.9279472301675508,-0.9286880411247964,-0.5378240505967229,0.5233357150134624,-0.1837710655065381,0.7830075487206323,-0.5440420859519186,-0.805568927037025,-0.3202558008990439,0.1757095345354478,0.2845524662302128,-0.203440841512488,0.5322858926190436,0.2203972433261444,-0.8109710606467267,0.5746607747520489,0.06140141032271403,0.7737922078527666,-0.01264685344464469,-0.6245753637844614,0.9231950696412683,0.3472817003064913,-0.2234519506933431,0.5233357150155543,0.1675901983419789,-0.4624241292804089,0.788395742104404,0.5440420855535101,-0.7538101642753309,0.3574127497332532,-0.2106776783891939,-0.2010368837014323,-0.4285218225217992,-0.5462080972117543,0.1510686558226817,-0.7723464339010514,0.7961810034266882,0.01466700900824698,0.5832144662608506,0.9281258464636363,-0.9241423251816583,0.3205923115448034],"type":"mesh3d","cmax":1.2326369859009898,"showscale":true,"i":[73,75,75,78,75,69,76,76,3,13,13,69,69,14,15,74,15,25,73,25,26,26,81,74,27,25,35,43,35,26,27,27,27,36,17,16,17,31,37,33,44,37,40,37,31,18,1,33,33,6,24,6,42,41,41,1,7,38,38,39,39,41,39,7,8,32,47,34,34,48,9,2,22,22,34,34,23,24,23,23,79,79,82,70,77,83,77,71,83,71,6,24,80,12,70,70,11,70,11,10,10,82,84,72,2,22,2,10,21,103,93,11,12,90,90,90,101,12,3,94,19,19,96,96,104,105,94,103,93,21,20,20,19,51,51,20,55,21,2,9,65,55,65,8,9,8,56,57,57,61,57,56,7,7,19,51,50,5,30,50,50,30,52,1,18,53,58,60,58,58,54,18,17,53,60,54,62,16,4,28,28,60,54,29,29,99,92,30,30,92,97,91,5,4,28,102,95,15,95,15,99,14,13,13,89,89,89,97,99,91,97,95],"x":[0.0,1.0,0.0,-1.0,0.0,0.0,0.0,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,0.382683433399756,0.7071067827963323,0.9238795329816334,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7712990323083161,0.7832272477767321,0.3356706794722105,0.3298749689110761,0.3364914460185361,0.4943952297128812,0.6320232753776565,0.9179912593601761,0.7153911315978191,0.9247531467450251,0.3182620519249885,0.203433905685737,0.3318408264151952,0.5143125473400065,0.5429324612788569,0.7870222781769127,0.5709878688487084,0.548159208602473,0.245818485602199,0.3356706784848726,0.3808964853234016,0.9238795324198404,0.7981217875261588,0.3239596588976609,0.3379819907524382,0.7746503893874387,0.6762424836312781,0.7952068115748919,0.9361182415880884,0.5777467987577226,0.2994166260385408,0.562382832032182,0.2757249102776845,0.5773131841244327,0.5386170967707806,0.574567817712664,0.2640750493746511,0.263493980133885,-0.74468532021765,-0.7832272498784563,-0.3356706794739731,-0.3170497837104079,-0.3223894903743267,-0.4529056211230371,-0.6625787199039502,-0.9191109782242952,-0.7287233245528806,-0.9247531468014573,-0.2988202233122857,-0.2980365799621815,-0.2206785197615534,-0.5499709374411073,-0.605699022153821,-0.5596453842745872,-0.8182637894780734,-0.5270908234911774,-0.2770728215968387,-0.5156487823651051,-0.8986511464928469,-0.7832272498729064,-0.4063938126620408,-0.3862195470199037,-0.5163412181949676,-0.322389490139929,-0.5613920645131396,-0.6259579275975956,-0.5654909043917722,-0.2733654792854792,-0.6948473165480623,-0.778708002159524,-0.9346316977858837,-0.2953075421955765,-0.2762115454076532,-0.7884200751658328,-0.580915463223325,-0.2626771556195345,-0.2665923213696816,-0.8002939626597124]}], "layout": {"template":{"layout":{"coloraxis":{"colorbar":{"ticks":"","outlinewidth":0}},"xaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"hovermode":"closest","paper_bgcolor":"white","geo":{"showlakes":true,"showland":true,"landcolor":"#E5ECF6","bgcolor":"white","subunitcolor":"white","lakecolor":"white"},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"yaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"shapedefaults":{"line":{"color":"#2a3f5f"}},"hoverlabel":{"align":"left"},"mapbox":{"style":"light"},"polar":{"angularaxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"autotypenumbers":"strict","font":{"color":"#2a3f5f"},"ternary":{"baxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"aaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"annotationdefaults":{"arrowhead":0,"arrowwidth":1,"arrowcolor":"#2a3f5f"},"plot_bgcolor":"#E5ECF6","title":{"x":0.05},"scene":{"xaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"zaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"yaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"}},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"]},"data":{"barpolar":[{"type":"barpolar","marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"carpet":[{"aaxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"},"type":"carpet","baxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"parcoords":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"parcoords"}],"scatter":[{"type":"scatter","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2dcontour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2dcontour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"mesh3d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"mesh3d"}],"surface":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"surface","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram":[{"type":"histogram","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"pie":[{"type":"pie","automargin":true}],"choropleth":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"choropleth"}],"heatmapgl":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmapgl","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"bar":[{"type":"bar","error_y":{"color":"#2a3f5f"},"error_x":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"heatmap":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmap","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contourcarpet"}],"table":[{"type":"table","header":{"line":{"color":"white"},"fill":{"color":"#C8D4E3"}},"cells":{"line":{"color":"white"},"fill":{"color":"#EBF0F8"}}}],"scatter3d":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"scatter3d","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2d","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}]}},"margin":{"l":50,"b":50,"r":50,"t":60},"title":"PMCHWT m"}, "config": {"showLink":false,"editable":false,"responsive":true,"staticPlot":false,"scrollZoom":true}}
    Plotly.newPlot(PLOT, plot_obj)

    // If width is not specified, set it to 100%
    PLOT.style.width = plot_obj.layout.width ? "" : "100%"
    
    // For the height we have to also put a fixed value in case the plot is put on a non-fixed-size container (like the default wrapper)
    PLOT.style.height = plot_obj.layout.height ? "" : "100%"
</script>

```

Plot electric surface current

````julia
plt = plot(patch(M, norm.(fcrm)),Layout(title="PMCHWT j"))
````

```@raw html
<div id='CL015SrPF3' class='' style=';'></div>
<script type="module">
    import Plotly from "https://esm.sh/plotly.js-dist-min@2.24.2"
    const PLOT = document.getElementById("CL015SrPF3")
    const plot_obj = {"data": [{"j":[86,86,83,85,85,78,85,78,78,78,69,74,86,74,74,81,27,71,75,73,73,81,86,86,81,35,43,45,45,43,16,43,36,45,36,36,31,45,45,44,46,46,46,40,40,40,40,35,37,33,42,42,44,44,42,38,38,39,46,46,47,47,44,32,48,48,48,48,49,49,49,49,49,34,47,41,41,79,79,72,82,88,88,82,85,85,88,83,88,80,80,80,88,76,76,77,84,84,70,84,87,84,87,87,87,87,106,106,106,106,106,93,90,105,93,108,108,101,101,96,94,91,104,108,108,108,105,105,105,103,103,94,51,55,66,55,67,67,67,67,67,66,66,65,65,56,66,66,64,64,58,57,56,52,61,61,61,61,50,64,63,63,59,59,59,59,59,64,64,60,62,53,62,62,62,68,68,68,68,68,54,63,63,63,102,102,102,92,98,98,98,98,98,107,107,107,107,107,100,95,100,100,100,89,101,104,100,104,104,104,99,102],"k":[75,69,71,75,83,75,78,3,13,69,14,14,74,15,27,27,4,6,71,71,25,73,73,81,26,26,26,36,43,27,4,36,16,31,31,17,18,37,35,37,37,40,38,31,18,1,38,25,35,25,6,33,33,42,24,7,32,32,39,44,32,39,41,8,9,8,32,47,48,9,2,22,34,23,41,23,24,23,72,22,72,82,77,77,76,77,83,80,80,6,24,79,79,3,12,76,70,82,12,11,84,72,72,22,10,2,21,2,103,93,10,10,11,93,11,105,90,90,12,91,91,5,91,104,101,96,96,94,103,20,94,19,20,20,55,21,21,2,9,65,55,65,56,56,8,7,57,51,58,57,52,52,52,1,51,57,5,19,5,61,60,50,1,18,53,58,52,50,60,53,60,17,16,17,53,62,16,4,28,54,29,54,29,30,28,92,29,29,92,97,91,5,30,15,4,28,102,95,14,14,95,13,89,3,3,101,99,99,89,97,92,99],"intensitymode":"cell","colorscale":"Viridis","intensity":[0.6670155780748358,0.5811131464590786,0.6613696674204136,0.4778926931832556,0.5785284581668706,0.4794326903080756,0.3478666742244294,0.24356293263006634,0.2342316943160475,0.41016856389620726,0.46420698686565526,0.6015623161373309,0.612106840370978,0.6501073395262147,0.7584689452169534,0.7432283832897973,0.7633660777633231,0.7651853389016474,0.6889367044077332,0.7478443807891553,0.7599480481855213,0.745487865302858,0.721777248700517,0.705760970705554,0.7535101951518067,0.7629458080764899,0.7558877490163811,0.6652698942854445,0.690501117475828,0.7644419193449061,0.7631165077595761,0.7507357856624777,0.7582219397925496,0.6025099931891049,0.5875115871620192,0.6513986639652016,0.4625275711417175,0.5531817512131292,0.6648076652704836,0.6556773482512573,0.6215197400291307,0.48852305072482227,0.37777355218960623,0.4978021158741123,0.3865463360464496,0.23530764601801027,0.24226414151922365,0.7506290359614431,0.6926424574327031,0.7648439544399256,0.7607007692210644,0.7528949497858144,0.7331164656465424,0.7110333013082639,0.743208631375335,0.24642904113092098,0.36394560114043123,0.4657176466860601,0.45896106490870414,0.5926066620310095,0.5479582754821839,0.6638303748797107,0.6837475041270636,0.4650991622655701,0.6610202771184828,0.5535882371072076,0.5970471147261053,0.665850985960946,0.710090461830153,0.7056411512164324,0.7707467380633011,0.7743379003214608,0.7528758228059308,0.7611293237653403,0.7065580485204834,0.7479530882504678,0.7610184373472652,0.7623576693189592,0.7483791702422375,0.7607046933952631,0.7083358432171636,0.683915314281023,0.6104072867042716,0.5572149645518877,0.45654712510033163,0.549648850422954,0.6128517307416298,0.7113361263421407,0.6896727497357296,0.7538235983675337,0.7719902397986925,0.7557772938480495,0.7215141531137585,0.24609573486773956,0.36507658542641386,0.46288714328537917,0.5489470252436941,0.6038922817240278,0.46494310592569255,0.6641571507444736,0.6899939144172099,0.6648891004675531,0.7016687573699307,0.7539589975103339,0.7715689664857943,0.7768127937737951,0.814736447988568,0.7865550730286527,0.8222732152318397,0.7789775209100449,0.7217469932613801,0.6813725886268005,0.4780694553170196,0.6555182246419796,0.6095390894342807,0.6216451891545157,0.42463485163619497,0.39417047640216446,0.2525855603366386,0.813816589978191,0.8895555663710291,0.9122742170873394,0.7297697477552382,0.6255959737199777,0.4826425019137535,0.6405650304776273,0.7813514189928699,0.8048368434129645,0.7639271543684021,0.8539339623322398,0.8582719361584387,0.8887204186854096,0.8920992636588825,0.8641964944645737,0.7895334973442745,0.8590519059517391,0.8255644518783212,0.8156995823263962,0.7878995896935687,0.7298267205606649,0.7648295188339653,0.7346305940075388,0.6572436171657139,0.5950706479377128,0.6759402165323783,0.4760956244030478,0.6021916104712723,0.7390426231193951,0.6383726326655644,0.7906564316385724,0.5460771489316533,0.5426464040587696,0.40201040625090007,0.2527382255643558,0.8853394596070502,0.7959314665732142,0.8992949571347856,0.9058110437999339,0.9164866994245535,0.8470857805924253,0.8230434778521147,0.888355533075321,0.25804122051029893,0.2431676757332994,0.39616654655250133,0.513424799517019,0.42421066825357456,0.7840418047357056,0.7000328368904475,0.6036257244638645,0.7174799403837651,0.4940151837806234,0.6766666025457971,0.5527534338725103,0.7145182839926321,0.7671760481645946,0.7253624648237841,0.78735364179278,0.8129125954893153,0.8224011991647989,0.854258108638469,0.789542646757864,0.856225275083342,0.8868435743335049,0.8532894655002319,0.767337227872028,0.8575216942741896,0.8946136236889677,0.8951389182307649,0.8299035103306341,0.823806425573227,0.8988626974948211,0.9135685806245505,0.7872811806290765,0.8135790641663645,0.8224682575987445,0.7737129202764956,0.7188243786744289,0.5983405081625547,0.6855345595639039,0.6642116735178918,0.47156011512342016,0.3948136613056958,0.2659676845680855,0.2716750893880703,0.42156115606289635,0.5148239754700404,0.6196792361831956,0.5850660162197449,0.7418742510800129,0.7490283623349743,0.7536840417012772],"z":[0.0,0.0,0.0,0.0,0.0,1.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,0.382683433399756,0.7071067827963323,0.9238795329816334,-0.358090195785944,-0.3356706795464228,-0.923879532419897,-0.5191908058184808,-0.7745103960432691,-0.3798118682651405,-0.7074461341000068,-0.3558187171535342,-0.6323665791883406,-0.3216262457876284,-0.7951427957591927,-0.9602757670306438,-0.5986575723510297,-0.8531172983050641,-0.5948346653831438,-0.6169231499928315,-0.551781317967993,-0.2637779472071395,-0.2458184864106502,0.9238795329815229,0.7559985333325001,0.3356706794744551,0.386219545565487,0.566280939665513,0.5201587399698409,0.3223894901462655,0.6684217588408458,0.5978407437028797,0.3023817416279478,0.7014616384018502,0.9295799197021266,0.2953075384244194,0.8097722402115327,0.8160225317063278,0.2765688812152579,0.5468701425065694,0.2630176920325818,0.2609778624806945,-0.3952076219559407,-0.3356706785514313,-0.923879532419716,-0.5351435445706977,-0.7746503890202773,-0.3820146622154342,-0.677071386133659,-0.3526487901310812,-0.6228902071913645,-0.3216262450197329,-0.7920720943565325,-0.9287622150683578,-0.5418735366387369,-0.6060502965361246,-0.7933212220609549,-0.2967198391184692,-0.574703774067069,-0.5762645909171411,-0.2663484839874635,-0.783263527733557,0.3774855528870367,0.3356706785611195,0.8981968572922676,0.7981217865457602,0.3344008077510922,0.7746503893976326,0.3414808722855108,0.6931325985739222,0.7973925964534126,0.9406675747184216,0.5775432921509455,0.3086592974673492,0.3219345441573563,0.5623828247401734,0.5383335322697146,0.6149623272382255,0.5678011191712297,0.2637861350446407,0.2736594544220287,0.5067051836213782],"cmin":0.2342316943160475,"y":[0.0,0.0,1.0,0.0,-1.0,0.0,0.0,0.382683433399756,0.7071067827963323,0.9238795329816334,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,0.382683433399756,0.7071067827963323,0.9238795329816334,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,-0.5261836318646177,0.5233357175207213,-0.183771065508847,0.7884309811514724,-0.5356371469355471,-0.7818671892093253,-0.3163329681330326,0.1751715966175198,0.2972003337091466,-0.2034408405550134,0.5161949250590815,0.1910107255395768,-0.7290341397978919,0.08759839599731206,-0.5927866929581042,0.001326897186858707,0.607873531887279,0.7936892821447811,0.9376281479749946,-0.1837710644888044,0.5323383182407485,0.1837710655050317,-0.462424128803026,-0.7578760035642076,0.7843488121747915,0.5440420855642704,0.3096909033864427,-0.1011561762507951,-0.1795770589359189,-0.4173250608048786,0.2150136203552799,-0.7723464300332932,-0.517923443025278,-0.02857822919119268,0.7958651123208982,0.6089374927558256,0.9279472301675508,-0.9286880411247964,-0.5378240505967229,0.5233357150134624,-0.1837710655065381,0.7830075487206323,-0.5440420859519186,-0.805568927037025,-0.3202558008990439,0.1757095345354478,0.2845524662302128,-0.203440841512488,0.5322858926190436,0.2203972433261444,-0.8109710606467267,0.5746607747520489,0.06140141032271403,0.7737922078527666,-0.01264685344464469,-0.6245753637844614,0.9231950696412683,0.3472817003064913,-0.2234519506933431,0.5233357150155543,0.1675901983419789,-0.4624241292804089,0.788395742104404,0.5440420855535101,-0.7538101642753309,0.3574127497332532,-0.2106776783891939,-0.2010368837014323,-0.4285218225217992,-0.5462080972117543,0.1510686558226817,-0.7723464339010514,0.7961810034266882,0.01466700900824698,0.5832144662608506,0.9281258464636363,-0.9241423251816583,0.3205923115448034],"type":"mesh3d","cmax":0.9164866994245535,"showscale":true,"i":[73,75,75,78,75,69,76,76,3,13,13,69,69,14,15,74,15,25,73,25,26,26,81,74,27,25,35,43,35,26,27,27,27,36,17,16,17,31,37,33,44,37,40,37,31,18,1,33,33,6,24,6,42,41,41,1,7,38,38,39,39,41,39,7,8,32,47,34,34,48,9,2,22,22,34,34,23,24,23,23,79,79,82,70,77,83,77,71,83,71,6,24,80,12,70,70,11,70,11,10,10,82,84,72,2,22,2,10,21,103,93,11,12,90,90,90,101,12,3,94,19,19,96,96,104,105,94,103,93,21,20,20,19,51,51,20,55,21,2,9,65,55,65,8,9,8,56,57,57,61,57,56,7,7,19,51,50,5,30,50,50,30,52,1,18,53,58,60,58,58,54,18,17,53,60,54,62,16,4,28,28,60,54,29,29,99,92,30,30,92,97,91,5,4,28,102,95,15,95,15,99,14,13,13,89,89,89,97,99,91,97,95],"x":[0.0,1.0,0.0,-1.0,0.0,0.0,0.0,0.923879532082714,0.7071067795767627,0.3826834312295725,-0.382683433399756,-0.7071067827963323,-0.9238795329816334,-0.923879532082714,-0.7071067795767627,-0.3826834312295725,0.382683433399756,0.7071067827963323,0.9238795329816334,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7712990323083161,0.7832272477767321,0.3356706794722105,0.3298749689110761,0.3364914460185361,0.4943952297128812,0.6320232753776565,0.9179912593601761,0.7153911315978191,0.9247531467450251,0.3182620519249885,0.203433905685737,0.3318408264151952,0.5143125473400065,0.5429324612788569,0.7870222781769127,0.5709878688487084,0.548159208602473,0.245818485602199,0.3356706784848726,0.3808964853234016,0.9238795324198404,0.7981217875261588,0.3239596588976609,0.3379819907524382,0.7746503893874387,0.6762424836312781,0.7952068115748919,0.9361182415880884,0.5777467987577226,0.2994166260385408,0.562382832032182,0.2757249102776845,0.5773131841244327,0.5386170967707806,0.574567817712664,0.2640750493746511,0.263493980133885,-0.74468532021765,-0.7832272498784563,-0.3356706794739731,-0.3170497837104079,-0.3223894903743267,-0.4529056211230371,-0.6625787199039502,-0.9191109782242952,-0.7287233245528806,-0.9247531468014573,-0.2988202233122857,-0.2980365799621815,-0.2206785197615534,-0.5499709374411073,-0.605699022153821,-0.5596453842745872,-0.8182637894780734,-0.5270908234911774,-0.2770728215968387,-0.5156487823651051,-0.8986511464928469,-0.7832272498729064,-0.4063938126620408,-0.3862195470199037,-0.5163412181949676,-0.322389490139929,-0.5613920645131396,-0.6259579275975956,-0.5654909043917722,-0.2733654792854792,-0.6948473165480623,-0.778708002159524,-0.9346316977858837,-0.2953075421955765,-0.2762115454076532,-0.7884200751658328,-0.580915463223325,-0.2626771556195345,-0.2665923213696816,-0.8002939626597124]}], "layout": {"template":{"layout":{"coloraxis":{"colorbar":{"ticks":"","outlinewidth":0}},"xaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"hovermode":"closest","paper_bgcolor":"white","geo":{"showlakes":true,"showland":true,"landcolor":"#E5ECF6","bgcolor":"white","subunitcolor":"white","lakecolor":"white"},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"yaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"shapedefaults":{"line":{"color":"#2a3f5f"}},"hoverlabel":{"align":"left"},"mapbox":{"style":"light"},"polar":{"angularaxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"autotypenumbers":"strict","font":{"color":"#2a3f5f"},"ternary":{"baxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"aaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"annotationdefaults":{"arrowhead":0,"arrowwidth":1,"arrowcolor":"#2a3f5f"},"plot_bgcolor":"#E5ECF6","title":{"x":0.05},"scene":{"xaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"zaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"yaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"}},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"]},"data":{"barpolar":[{"type":"barpolar","marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"carpet":[{"aaxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"},"type":"carpet","baxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"parcoords":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"parcoords"}],"scatter":[{"type":"scatter","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2dcontour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2dcontour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"mesh3d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"mesh3d"}],"surface":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"surface","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram":[{"type":"histogram","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"pie":[{"type":"pie","automargin":true}],"choropleth":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"choropleth"}],"heatmapgl":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmapgl","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"bar":[{"type":"bar","error_y":{"color":"#2a3f5f"},"error_x":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"heatmap":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmap","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contourcarpet"}],"table":[{"type":"table","header":{"line":{"color":"white"},"fill":{"color":"#C8D4E3"}},"cells":{"line":{"color":"white"},"fill":{"color":"#EBF0F8"}}}],"scatter3d":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"scatter3d","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2d","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}]}},"margin":{"l":50,"b":50,"r":50,"t":60},"title":"PMCHWT j"}, "config": {"showLink":false,"editable":false,"responsive":true,"staticPlot":false,"scrollZoom":true}}
    Plotly.newPlot(PLOT, plot_obj)

    // If width is not specified, set it to 100%
    PLOT.style.width = plot_obj.layout.width ? "" : "100%"
    
    // For the height we have to also put a fixed value in case the plot is put on a non-fixed-size container (like the default wrapper)
    PLOT.style.height = plot_obj.layout.height ? "" : "100%"
</script>

```

---

*This page was generated using [Literate.jl](https://github.com/fredrikekre/Literate.jl).*

