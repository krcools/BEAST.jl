```@meta
EditURL = "../../../examples/pmchwt_theta.jl"
```

# Higher-order Multiplicative Calderon Preconditioning

We begin with loading the needed packages

````julia
using CompScienceMeshes, BEAST
using LinearAlgebra
using PlotlyJS
````

Then we start with defining the geometry and creating the mesh.

````julia
h=0.5
M = meshsphere(1.0, h; generator=:gmsh);
````

Once the geometry has been created, the basis function space ``X`` can be defined on the mesh.
In this example, we use basis functions of order ``p=1``. Further, higher-order basis space ``Y`` will be needed to build a preconditioner.

````julia
p=1
X = BEAST.gwpdiv(M;order=p)
Y = BEAST.gwpdiv(M;order=p+2);
````

Defintion of material properties

````julia
κ,  η  = 1.0, 1.0
κ′, η′ = √2.0κ, η/√2.0
α, α′ = 1/η, 1/η′;
````

Defintion of integral operators and excitation.

````julia
T = Maxwell3D.singlelayer(wavenumber=κ)
T′ = Maxwell3D.singlelayer(wavenumber=κ′)
K  = Maxwell3D.doublelayer(wavenumber=κ)
K′ = Maxwell3D.doublelayer(wavenumber=κ′)
E = Maxwell3D.planewave(direction=ẑ, polarization=x̂, wavenumber=κ);
H = -1/(im*κ*η)*curl(E)

e = (n × E) × n
h = (n × H) × n;
````

Next, we increase the default number of quadrature points, since higher order basis are used.

````julia
BEAST.@defaultquadstrat (T,X,X) BEAST.DoubleNumSauterQstrat(7,7,6,6,6,6)
BEAST.@defaultquadstrat (K,X,X) BEAST.DoubleNumSauterQstrat(7,7,6,6,6,6)
BEAST.@defaultquadstrat (e,X) BEAST.SingleNumQStrat(10)
BEAST.@defaultquadstrat (h,X) BEAST.SingleNumQStrat(10);
````

Here is the core that allows Calderon preconditioning for a higher order basis, without using dual functions.
The ``\Theta``-operators enable mapping a lower-order solenoidal subspace into a higher-order nonsolenoidal subspace and vice-versa.
They are defined like this:

```math
\begin{aligned}
  \Theta_\Sigma  &= P_\Sigma^r N_{rp} P_\Lambda^p \\
  \Theta_\Lambda &= P_\Lambda^r N_{rp} P_\Sigma^p
\end{aligned}
```

where PΣ and PΛ are the quasi-Helmholtz projectors, N the mixed Gram matrix of the lower and higher order basis, and the super-/subscripts indicate the order of the basis.

````julia
ΘΣ = BEAST.ThetaStars()
ΘΛ = BEAST.ThetaLoops();
````

With everthing defined and setup, the linear system can be built.

````julia
@hilbertspace j m
@hilbertspace r s;
````

In a first step, the standard PMCHWT system is assembled based on the basis ``X``.

````julia
Ah = assemble( (η*T+η′*T′)[r,j] -      (K+K′)[r,m] +
                    (K+K′)[s,j] + (α*T+α′*T′)[s,m], s∈X, r∈X, j∈X, m∈X);
````

Next, we assemble the block diagonal preconditioner using the higher order basis ``Y``.

````julia
Ch = assemble(T[r,j]+T[s,m],s∈Y, r∈Y, j∈Y, m∈Y);
````

The ``\Theta``-Operator can be assembled like other operators. Mapping from the lowere order basis ``X`` to the higher order basis ``Y``.

````julia
Θh = assemble( ΘΣ[r,j] + ΘΛ[r,j] + ΘΣ[s,m] + ΘΛ[s,m] ,s∈Y, r∈Y, j∈X, m∈X);
````

And last but not least, the right hand side is assembled too.

````julia
bh = assemble(-e[j]-h[m],j ∈ X, m∈X);
````

After everything has been assembled the linear system can be solved using GMRES.
Once using the higher order preconditioner

````julia
u, stats = solve(BEAST.GMRES(Ah; M=Θh'*Ch*Θh, restart=true, atol=1e-8, rtol=1e-8, verbose=0, memory=50),bh);
````

And without using a preconditioner

````julia
uref, statsref = solve(BEAST.GMRES(Ah; restart=true, atol=1e-8, rtol=1e-8, verbose=0, memory=500),bh);
````

The number of iterations for the preconditioned system:


````
34
````

And the regular system:


````
420
````

Visualizationf of the solution

````julia
fcrj, _ = facecurrents(u[j],X)
fcrm, _ = facecurrents(u[m],X);
````

Plot magnetic surface current

````julia
plt = plot(patch(M, norm.(fcrj)),Layout(title="PMCHWT m"))
````

```@raw html
<div id='8ugMHW8QZj' class='' style=';'></div>
<script type="module">
    import Plotly from "https://esm.sh/plotly.js-dist-min@2.24.2"
    const PLOT = document.getElementById("8ugMHW8QZj")
    const plot_obj = {"data": [{"j":[83,83,75,81,81,78,81,78,78,78,68,83,71,71,84,84,84,84,84,69,76,74,72,72,82,83,83,82,46,46,46,34,48,48,48,48,34,34,32,35,36,41,47,44,44,44,44,46,46,46,42,42,33,42,45,37,44,39,39,40,44,47,47,47,45,47,31,38,38,45,38,2,43,43,43,45,43,37,70,79,79,79,79,77,81,81,76,76,76,76,67,80,80,80,80,80,73,85,85,85,85,85,104,104,104,104,104,89,87,91,89,101,101,101,99,99,99,98,98,98,103,101,92,96,102,102,102,102,99,50,65,53,53,66,66,66,66,65,54,53,54,55,65,65,61,61,57,54,58,58,60,60,60,49,60,61,62,62,58,58,58,58,61,61,59,63,52,63,63,63,64,64,64,64,64,56,62,62,62,100,100,100,100,90,90,105,88,28,100,95,95,95,97,86,93,93,101,101,94,97,105,105,103,103,105,105],"k":[74,68,69,74,75,74,78,3,13,68,14,71,14,15,15,71,82,27,4,6,6,69,69,25,72,72,82,26,26,34,35,27,27,4,16,34,32,17,18,32,32,36,36,36,32,18,1,25,41,42,33,25,6,6,33,33,39,7,31,31,40,41,40,45,31,33,8,9,8,38,22,9,22,23,38,37,37,24,23,23,22,70,77,70,67,77,69,24,70,75,3,67,77,11,73,12,11,73,79,22,10,2,21,2,102,89,10,10,11,89,11,92,87,12,91,96,98,5,88,96,96,94,91,91,91,89,20,99,19,20,53,20,21,21,2,9,53,54,8,8,7,51,50,55,57,55,51,51,1,7,50,55,19,5,5,60,59,49,18,52,57,51,49,59,52,59,17,16,17,52,63,16,4,28,56,29,56,29,30,28,90,97,29,29,30,90,30,15,95,15,14,86,86,13,13,3,3,93,93,94,94,103,92,88,88,97],"intensitymode":"cell","colorscale":"Viridis","intensity":[1.0837635290374068,1.0419811351129502,1.1903050396676038,1.1152129306750662,1.1671658804566898,1.0783875290853842,1.110248918372304,1.0767156009583438,1.0425623581630739,0.9902311914511815,0.9147775742543023,0.9004485291544475,0.8368651564998454,0.672470826185157,0.6215829182919457,0.7166894853697366,0.6718011292419963,0.44914701262309076,0.4080548492702008,1.2157823256481812,1.2310103521645654,1.1449384682323274,1.154331966482278,1.0661559851479805,0.9489689218848327,0.9471316754387825,0.8520731387394037,0.7860441889144615,1.064975128808943,0.9315516620053235,0.9462947898886251,0.7971170346023204,0.6973042721559229,0.44353386198464717,0.3910326253829789,0.653980207672278,0.8062121231840815,0.7059684663062034,0.9111036218729945,0.9299019319333784,1.0737012820649632,1.135642943690001,1.1830761485848806,1.1347320949640383,1.0801328535331545,1.0311255069059475,1.0438663041424248,1.1763481403298957,1.1376295602492332,1.1700397210243796,1.2185426539218556,1.2155206267901049,1.215576514783399,1.2298369906907418,1.1270394691398113,1.1359645194938732,1.0746217297041925,1.042615524520455,0.9988163650938222,1.0542365052459448,1.1101974898291997,1.2068878249669515,1.1654846769986333,1.1334582664676243,1.0531765963147124,1.1527688800876896,0.9083050435002767,0.6974460062861413,0.7943364113482768,0.9197307977053304,0.5192392336985556,0.4846377576979557,0.6537787092096172,0.7837385617725224,0.8998897337136171,0.9392237862104096,0.9484292183541319,1.0671352734647073,1.0676510825176602,1.0000030462703702,0.7869212364740928,0.9843858002465486,0.950498560475884,1.13559169019816,1.1037457803256963,1.1430832330793992,1.215891150455071,1.2156548141475374,1.155329443612524,1.174950471472962,1.0445050067426933,1.018004038327947,1.052283865951284,0.8354728837613827,0.9384084987161314,0.9020854337204858,0.6688772229892153,0.6334926103686542,0.7331019072872673,0.6919309896652823,0.407679749616009,0.4484581178703947,0.365590049255898,0.37488937436489095,0.5699750388494506,0.6266530175480576,0.560155485645975,0.6392532051657777,0.8848909971330341,0.8426160225065114,0.7800284877220585,1.0043642755937294,0.9856002904914591,1.0233764262638307,1.0362858086107565,1.0955989922968372,1.0896451448395397,1.1534660720826364,1.170754000863959,1.1535171004769371,1.1028207873000129,1.0630906226639325,0.9844335741748453,1.0408192322505603,0.8829242354179967,0.7935156996869934,0.6733289439155347,0.8677257197721401,0.9806715303186712,0.9800362344485578,0.823064740382428,0.7958833455153306,0.6830017604929053,0.5618829070371898,0.3549882744626356,0.3799974917668113,0.5607042535647258,0.8030429557508939,0.7320215906021886,0.6484253955141384,0.8861073246118659,0.9996760971158749,1.015271849851886,0.9847621095132423,1.0925107251335604,1.1117497174012507,1.0641458872391636,0.9764813508519263,1.0235122943747177,1.0255901235261882,1.08995145735133,1.0650981433920645,1.1517568019988402,1.152060446149444,1.1663505284754707,1.1424133825218012,1.058619517425285,1.0900420318137034,1.023378168472593,0.9950038247831248,1.018150369516893,1.0489610658344428,1.0886429952429597,1.0675384602519893,1.0094761143252586,0.8521426513014765,0.8840627365506052,0.6361979056564663,0.8245791601486115,0.856074347127465,0.6317116840666783,0.5619996556517429,0.37412579965889764,0.36350176113116645,0.585541054421051,0.6777699349706919,0.9126866341118347,0.8511221337218494,0.9797025401184408,0.6829872215659207,0.9063660352326647,0.8189047819721244,0.876769901636974,0.9803258607389517,1.0854162345219591,1.0698990804564796,1.1524270114152422,0.39960577385255547,0.5902908326412363,0.48211798350262125,0.6429440583738435,0.7672959047236328,0.8401339609747578,0.8854677332891051,0.9588089525743735,1.0242425363340106,1.038340487743648,1.0465571709729828,0.9935459150174788,0.9788245327321704,1.0180083731151308,1.0804467451159652,1.0891512675008057,1.1357431287861257,1.1139683693708164,0.9989440156170386],"z":[0.0,0.0,0.0,0.0,0.0,1.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.3826834333979132,0.7071067827953921,0.923879532981379,-0.3356706795491227,-0.3637127675023253,-0.9238795329820394,-0.4530293582957106,-0.6692247133044283,-0.6305198758152588,-0.7204640292387433,-0.4013277737374842,-0.3080345103461303,-0.5843316050992045,-0.8473355055149928,-0.9479859314805893,-0.5700830833132272,-0.338189466473898,-0.6704296588588871,-0.8224991324221956,-0.7836123611171548,-0.2282041218462557,0.9174529265187842,0.7832272477750071,0.4279761179685044,0.3689929983432182,0.415961558062963,0.3898497254377044,0.6920342899966984,0.5606758151978906,0.5975220768784559,0.2936678753331954,0.6894993849886951,0.9093113361973848,0.8094786964135379,0.8030838257118262,0.2953075395076857,0.2602632754518163,0.603071298404603,0.2152655366920699,-0.3356706784848716,-0.3808964841433509,-0.9238795324201515,-0.7981217887987166,-0.3379819895661691,-0.7746503893886751,-0.3239596598488569,-0.6762424855469249,-0.7952068150432718,-0.9361182418192057,-0.5777468006918589,-0.2994166236192424,-0.5623828347660068,-0.275724909850002,-0.5773131863570596,-0.53861709557641,-0.5745678190123881,-0.2640750368477738,-0.2634939812927687,0.3513071891109492,0.3356706785585945,0.921313057837993,0.335670679552531,0.7779731754970509,0.6369620407364327,0.6457137402660281,0.2995589796594878,0.6000086861270972,0.3861150612529765,0.8463818460199263,0.6169181821239152,0.9602757685260597,0.8193076438561867,0.6077284384189419,0.3422050049022389,0.5502882793319617,0.7913884131005398,0.278138829020665,0.770667727657496],"cmin":0.3549882744626356,"y":[0.0,0.0,1.0,0.0,-1.0,0.0,0.0,0.3826834333979132,0.7071067827953921,0.923879532981379,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.3826834333979132,0.7071067827953921,0.923879532981379,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.5233357175214735,-0.5046166372516803,0.1837710644859887,-0.7885109542860995,-0.5087606979406201,-0.1700149623011439,0.6123380409223154,0.8233298462825775,0.2180173297641873,0.2236312378448529,-0.161861947498311,-0.1343905058979935,0.7919936429552381,-0.09658127919940886,0.4546185205602883,-0.4869773680366361,0.116714575689537,-0.949091510347575,-0.1959531926664808,0.5233357175216284,0.1602558261900864,-0.4716835705590967,0.8086729650709266,0.5405338228902928,0.2817787929644262,-0.7598816736557852,-0.117723163150677,-0.06609898711265692,-0.4354437418421072,0.1697737992530071,-0.06193337606067247,-0.5317435933582012,-0.7723464311446644,-0.9287334199541304,0.5519091917197483,0.9525871736761117,0.1837710644889991,-0.5323383202425732,-0.1837710655041242,0.4624241276440079,-0.7843488129695446,-0.5440420855630059,0.7578760036106794,-0.3096909031454055,0.1011561751245867,0.1795770578518685,0.417325061138499,-0.2150136256970092,0.7723464285833307,0.5179234454109362,0.02857822718637093,-0.7958651124107581,-0.6089374928401624,-0.927947235838083,0.9286880404659718,-0.5204348877279751,0.5233357150140923,-0.1697364862631958,0.7832272477737154,-0.5336599925116123,0.5451051985979479,0.1862095822879817,-0.2069032193660246,-0.2090262328070707,-0.7790195354818714,0.2049469131089399,-0.5410617362475398,0.1910107270085014,0.5025105459768819,-0.7196996289426292,0.1109546359080374,0.785449232181453,-0.06276217412373544,0.9246086295290713,-0.3101855006157244],"type":"mesh3d","cmax":1.2310103521645654,"showscale":true,"i":[72,74,74,78,74,68,67,67,3,13,13,68,68,14,71,82,27,4,15,25,69,72,25,26,26,82,71,27,25,26,34,26,34,27,4,16,17,16,17,34,35,35,41,40,36,32,18,42,35,41,41,6,24,33,37,24,1,1,7,39,39,33,36,40,40,45,7,8,31,31,9,22,38,22,37,38,23,23,24,70,23,77,73,75,77,75,75,6,24,70,12,12,67,73,77,11,10,10,73,79,2,22,2,10,21,102,89,11,12,87,87,87,12,3,96,98,19,19,5,88,92,92,87,92,99,91,21,20,20,19,50,50,20,53,21,2,9,53,53,9,8,54,55,54,55,60,55,7,7,51,19,50,5,30,49,49,49,30,1,18,52,57,59,57,57,56,18,17,52,59,56,63,16,4,28,28,59,56,29,29,97,95,90,30,88,88,5,4,28,28,15,14,95,14,86,13,93,94,86,86,97,94,94,96,103,90],"x":[0.0,1.0,0.0,-1.0,0.0,0.0,0.0,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.3826834333979132,0.7071067827953921,0.923879532981379,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7832272477750726,0.7829911060571543,0.3356706784849925,0.4159505685691526,0.541572557773729,0.7573239721517148,0.3255360290543831,0.4013277740790213,0.9260578731150195,0.7800933564274,0.505789730071406,0.2885513223663358,0.2185208174032275,0.9361089366490986,0.5863838958275809,0.2938506766792381,0.6101879835968659,0.2171363252856099,0.3462404856540195,0.3356706795490336,0.8894686687122495,0.800848785001453,0.4159615580522173,0.7455470326463328,0.6645970608603958,0.3289718411874543,0.793163680775069,0.9536194748954991,0.578774002345264,0.3799075557949935,0.5838736995124602,0.2688961134017468,0.5623828299370605,0.2640402660796208,0.5759351119143893,0.2150312192692787,-0.9238795329814845,-0.7559985325174577,-0.3356706794740955,-0.3862195443234521,-0.5201587395422288,-0.3223894901454282,-0.5662809390591549,-0.6684217570144617,-0.5978407392800358,-0.3023817415562419,-0.7014616366103491,-0.9295799192458276,-0.295307537010359,-0.8097722388313109,-0.8160225301970181,-0.2765688832827075,-0.546870141047109,-0.2630176846037312,-0.2609778636550608,-0.7782870848951134,-0.7832272498749652,-0.3498167730230086,-0.5233357175213185,-0.3316093343070137,-0.5451052018852607,-0.7405266754788727,-0.9313728982106689,-0.7722030889413216,-0.4940078165487054,-0.4915633565828705,-0.5715454086367254,-0.2034338972476547,-0.2760763226009069,-0.3357061054504618,-0.9330513401685748,-0.2832883924474048,-0.6080832912598992,-0.26026462301163,-0.5566472929557854]}], "layout": {"template":{"layout":{"coloraxis":{"colorbar":{"ticks":"","outlinewidth":0}},"xaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"hovermode":"closest","paper_bgcolor":"white","geo":{"showlakes":true,"showland":true,"landcolor":"#E5ECF6","bgcolor":"white","subunitcolor":"white","lakecolor":"white"},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"yaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"shapedefaults":{"line":{"color":"#2a3f5f"}},"hoverlabel":{"align":"left"},"mapbox":{"style":"light"},"polar":{"angularaxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"autotypenumbers":"strict","font":{"color":"#2a3f5f"},"ternary":{"baxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"aaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"annotationdefaults":{"arrowhead":0,"arrowwidth":1,"arrowcolor":"#2a3f5f"},"plot_bgcolor":"#E5ECF6","title":{"x":0.05},"scene":{"xaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"zaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"yaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"}},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"]},"data":{"barpolar":[{"type":"barpolar","marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"carpet":[{"aaxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"},"type":"carpet","baxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"parcoords":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"parcoords"}],"scatter":[{"type":"scatter","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2dcontour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2dcontour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"mesh3d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"mesh3d"}],"surface":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"surface","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram":[{"type":"histogram","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"pie":[{"type":"pie","automargin":true}],"choropleth":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"choropleth"}],"heatmapgl":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmapgl","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"bar":[{"type":"bar","error_y":{"color":"#2a3f5f"},"error_x":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"heatmap":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmap","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contourcarpet"}],"table":[{"type":"table","header":{"line":{"color":"white"},"fill":{"color":"#C8D4E3"}},"cells":{"line":{"color":"white"},"fill":{"color":"#EBF0F8"}}}],"scatter3d":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"scatter3d","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2d","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}]}},"margin":{"l":50,"b":50,"r":50,"t":60},"title":"PMCHWT m"}, "config": {"showLink":false,"editable":false,"responsive":true,"staticPlot":false,"scrollZoom":true}}
    Plotly.newPlot(PLOT, plot_obj)

    // If width is not specified, set it to 100%
    PLOT.style.width = plot_obj.layout.width ? "" : "100%"
    
    // For the height we have to also put a fixed value in case the plot is put on a non-fixed-size container (like the default wrapper)
    PLOT.style.height = plot_obj.layout.height ? "" : "100%"
</script>

```

Plot electric surface current

````julia
plt = plot(patch(M, norm.(fcrm)),Layout(title="PMCHWT j"))
````

```@raw html
<div id='Nc34XLMBZJ' class='' style=';'></div>
<script type="module">
    import Plotly from "https://esm.sh/plotly.js-dist-min@2.24.2"
    const PLOT = document.getElementById("Nc34XLMBZJ")
    const plot_obj = {"data": [{"j":[83,83,75,81,81,78,81,78,78,78,68,83,71,71,84,84,84,84,84,69,76,74,72,72,82,83,83,82,46,46,46,34,48,48,48,48,34,34,32,35,36,41,47,44,44,44,44,46,46,46,42,42,33,42,45,37,44,39,39,40,44,47,47,47,45,47,31,38,38,45,38,2,43,43,43,45,43,37,70,79,79,79,79,77,81,81,76,76,76,76,67,80,80,80,80,80,73,85,85,85,85,85,104,104,104,104,104,89,87,91,89,101,101,101,99,99,99,98,98,98,103,101,92,96,102,102,102,102,99,50,65,53,53,66,66,66,66,65,54,53,54,55,65,65,61,61,57,54,58,58,60,60,60,49,60,61,62,62,58,58,58,58,61,61,59,63,52,63,63,63,64,64,64,64,64,56,62,62,62,100,100,100,100,90,90,105,88,28,100,95,95,95,97,86,93,93,101,101,94,97,105,105,103,103,105,105],"k":[74,68,69,74,75,74,78,3,13,68,14,71,14,15,15,71,82,27,4,6,6,69,69,25,72,72,82,26,26,34,35,27,27,4,16,34,32,17,18,32,32,36,36,36,32,18,1,25,41,42,33,25,6,6,33,33,39,7,31,31,40,41,40,45,31,33,8,9,8,38,22,9,22,23,38,37,37,24,23,23,22,70,77,70,67,77,69,24,70,75,3,67,77,11,73,12,11,73,79,22,10,2,21,2,102,89,10,10,11,89,11,92,87,12,91,96,98,5,88,96,96,94,91,91,91,89,20,99,19,20,53,20,21,21,2,9,53,54,8,8,7,51,50,55,57,55,51,51,1,7,50,55,19,5,5,60,59,49,18,52,57,51,49,59,52,59,17,16,17,52,63,16,4,28,56,29,56,29,30,28,90,97,29,29,30,90,30,15,95,15,14,86,86,13,13,3,3,93,93,94,94,103,92,88,88,97],"intensitymode":"cell","colorscale":"Viridis","intensity":[0.6681740037323014,0.5651964458169385,0.659016697991962,0.4667760675949726,0.5837427773014572,0.4761506755800994,0.3462320780639668,0.24388519223602065,0.23025760687744717,0.40904284901204135,0.46702097307012463,0.6036757000050962,0.566691038432411,0.6620978674935297,0.6878702340224049,0.7133628959698556,0.7504490810090935,0.7766851467618705,0.7721352880446363,0.7677335357680652,0.7548446970129611,0.6879612490752317,0.74768197436406,0.7613389370750915,0.7456681928180123,0.7095322053497883,0.6877817937154562,0.7522991330464909,0.7581524907551551,0.7459295704087562,0.7228764239739232,0.7570461618276273,0.7480693589441686,0.7724903665040916,0.76317397509659,0.6751856856845266,0.6242814733469187,0.6675837529238984,0.4606951099804516,0.6176508470461124,0.5508182030392228,0.6237969468499713,0.600195306863219,0.44396369057887397,0.44352606818968937,0.35234247221503223,0.25055407984840716,0.7537304921670358,0.6844856462742535,0.7160148085052372,0.6998385537450821,0.7668813883269524,0.7675014838200884,0.7575680977024717,0.7136169002314037,0.7489606254304749,0.2279106316302546,0.23194341527246853,0.38055077262049425,0.4626834315392022,0.41159589239412503,0.7001791666237751,0.52840067322533,0.6000219799882787,0.5346854056454222,0.6852367954896537,0.45686091468844997,0.6545823413897827,0.630382604688735,0.643297023346321,0.7594338572024405,0.7709675321293368,0.7459162341101625,0.7588051972301476,0.6772602476024975,0.664082901605033,0.7440979850696737,0.7521662000773506,0.75820080130166,0.7425325377662113,0.761927124892022,0.6667063741144581,0.6684290268316938,0.6493784038337308,0.477210460896718,0.5527462880055739,0.700832990977349,0.7666951491645859,0.7522061775674865,0.6815054697727064,0.2406952105175142,0.3442698899393897,0.44895590653634165,0.5597209746764279,0.5874926102857359,0.46072939387299267,0.6665298503165201,0.6887809618151803,0.7077033359958698,0.7469601010211986,0.767723720760151,0.7611645962891745,0.81570246129945,0.7856982282100652,0.8211077385039148,0.7754489620547039,0.7238521477790337,0.6812972094481572,0.4772676420116011,0.6736709497391329,0.6057573346696679,0.5144816717267116,0.38239018135963737,0.2634370152792104,0.7966204607782442,0.8610990643504369,0.8842339787731812,0.902412754051213,0.8966677639698943,0.8625971653179445,0.7123334869725494,0.5139378554676222,0.6136101064334009,0.7265019684288945,0.8229802707467906,0.753453698872404,0.8444657897315868,0.8555148424268242,0.889314518091301,0.8956006428911497,0.8149089757168321,0.8580643269511007,0.8447673882410641,0.8114785486913898,0.8100121402576002,0.7803181592212601,0.7223919232158826,0.6939787088085428,0.6649950680210027,0.6878496915317687,0.4787619231638994,0.5675225493267883,0.7736736348872233,0.6020111043782433,0.6444075666010467,0.7576808728965537,0.5962220434661925,0.40717801790959585,0.32022089400988074,0.26271451001364826,0.8911543977569987,0.7998797108430535,0.921239773581815,0.9139485700565453,0.9059126533658548,0.829772424820503,0.8224333036423226,0.8880158325712787,0.26067229610494613,0.3629315516373974,0.4613806700365854,0.44946053486359067,0.7830544544186333,0.6945166770413189,0.5983173942352752,0.7163426655351394,0.4895114627507398,0.6793723397126774,0.5589036418204311,0.7026393128950632,0.7646670038460267,0.7239418719738102,0.7825657122828118,0.7990991353921578,0.8178544884578153,0.8505572603296752,0.7928520257254817,0.8572329298211367,0.8916288825718478,0.8573222134672106,0.7864364065371178,0.7385464593088354,0.8723393878016935,0.8982146562958723,0.8943915540556486,0.8412882965790682,0.9134856872059133,0.7947463358017476,0.8331316875853297,0.8061822972230679,0.6736549957109896,0.6253502532995777,0.6726232661195561,0.4778622450006051,0.41263125536262335,0.2412931838816339,0.24768058300740414,0.46506060018448614,0.5138154528312889,0.6137203874153838,0.6591969684424132,0.6830253312465084,0.6035153817989218,0.8293486758965725,0.7924324472275678,0.7802497159380453],"z":[0.0,0.0,0.0,0.0,0.0,1.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.3826834333979132,0.7071067827953921,0.923879532981379,-0.3356706795491227,-0.3637127675023253,-0.9238795329820394,-0.4530293582957106,-0.6692247133044283,-0.6305198758152588,-0.7204640292387433,-0.4013277737374842,-0.3080345103461303,-0.5843316050992045,-0.8473355055149928,-0.9479859314805893,-0.5700830833132272,-0.338189466473898,-0.6704296588588871,-0.8224991324221956,-0.7836123611171548,-0.2282041218462557,0.9174529265187842,0.7832272477750071,0.4279761179685044,0.3689929983432182,0.415961558062963,0.3898497254377044,0.6920342899966984,0.5606758151978906,0.5975220768784559,0.2936678753331954,0.6894993849886951,0.9093113361973848,0.8094786964135379,0.8030838257118262,0.2953075395076857,0.2602632754518163,0.603071298404603,0.2152655366920699,-0.3356706784848716,-0.3808964841433509,-0.9238795324201515,-0.7981217887987166,-0.3379819895661691,-0.7746503893886751,-0.3239596598488569,-0.6762424855469249,-0.7952068150432718,-0.9361182418192057,-0.5777468006918589,-0.2994166236192424,-0.5623828347660068,-0.275724909850002,-0.5773131863570596,-0.53861709557641,-0.5745678190123881,-0.2640750368477738,-0.2634939812927687,0.3513071891109492,0.3356706785585945,0.921313057837993,0.335670679552531,0.7779731754970509,0.6369620407364327,0.6457137402660281,0.2995589796594878,0.6000086861270972,0.3861150612529765,0.8463818460199263,0.6169181821239152,0.9602757685260597,0.8193076438561867,0.6077284384189419,0.3422050049022389,0.5502882793319617,0.7913884131005398,0.278138829020665,0.770667727657496],"cmin":0.2279106316302546,"y":[0.0,0.0,1.0,0.0,-1.0,0.0,0.0,0.3826834333979132,0.7071067827953921,0.923879532981379,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.3826834333979132,0.7071067827953921,0.923879532981379,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.5233357175214735,-0.5046166372516803,0.1837710644859887,-0.7885109542860995,-0.5087606979406201,-0.1700149623011439,0.6123380409223154,0.8233298462825775,0.2180173297641873,0.2236312378448529,-0.161861947498311,-0.1343905058979935,0.7919936429552381,-0.09658127919940886,0.4546185205602883,-0.4869773680366361,0.116714575689537,-0.949091510347575,-0.1959531926664808,0.5233357175216284,0.1602558261900864,-0.4716835705590967,0.8086729650709266,0.5405338228902928,0.2817787929644262,-0.7598816736557852,-0.117723163150677,-0.06609898711265692,-0.4354437418421072,0.1697737992530071,-0.06193337606067247,-0.5317435933582012,-0.7723464311446644,-0.9287334199541304,0.5519091917197483,0.9525871736761117,0.1837710644889991,-0.5323383202425732,-0.1837710655041242,0.4624241276440079,-0.7843488129695446,-0.5440420855630059,0.7578760036106794,-0.3096909031454055,0.1011561751245867,0.1795770578518685,0.417325061138499,-0.2150136256970092,0.7723464285833307,0.5179234454109362,0.02857822718637093,-0.7958651124107581,-0.6089374928401624,-0.927947235838083,0.9286880404659718,-0.5204348877279751,0.5233357150140923,-0.1697364862631958,0.7832272477737154,-0.5336599925116123,0.5451051985979479,0.1862095822879817,-0.2069032193660246,-0.2090262328070707,-0.7790195354818714,0.2049469131089399,-0.5410617362475398,0.1910107270085014,0.5025105459768819,-0.7196996289426292,0.1109546359080374,0.785449232181453,-0.06276217412373544,0.9246086295290713,-0.3101855006157244],"type":"mesh3d","cmax":0.921239773581815,"showscale":true,"i":[72,74,74,78,74,68,67,67,3,13,13,68,68,14,71,82,27,4,15,25,69,72,25,26,26,82,71,27,25,26,34,26,34,27,4,16,17,16,17,34,35,35,41,40,36,32,18,42,35,41,41,6,24,33,37,24,1,1,7,39,39,33,36,40,40,45,7,8,31,31,9,22,38,22,37,38,23,23,24,70,23,77,73,75,77,75,75,6,24,70,12,12,67,73,77,11,10,10,73,79,2,22,2,10,21,102,89,11,12,87,87,87,12,3,96,98,19,19,5,88,92,92,87,92,99,91,21,20,20,19,50,50,20,53,21,2,9,53,53,9,8,54,55,54,55,60,55,7,7,51,19,50,5,30,49,49,49,30,1,18,52,57,59,57,57,56,18,17,52,59,56,63,16,4,28,28,59,56,29,29,97,95,90,30,88,88,5,4,28,28,15,14,95,14,86,13,93,94,86,86,97,94,94,96,103,90],"x":[0.0,1.0,0.0,-1.0,0.0,0.0,0.0,0.9238795320834773,0.707106779577703,0.3826834312301867,-0.3826834333979132,-0.7071067827953921,-0.923879532981379,-0.9238795320834773,-0.707106779577703,-0.3826834312301867,0.3826834333979132,0.7071067827953921,0.923879532981379,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7832272477750726,0.7829911060571543,0.3356706784849925,0.4159505685691526,0.541572557773729,0.7573239721517148,0.3255360290543831,0.4013277740790213,0.9260578731150195,0.7800933564274,0.505789730071406,0.2885513223663358,0.2185208174032275,0.9361089366490986,0.5863838958275809,0.2938506766792381,0.6101879835968659,0.2171363252856099,0.3462404856540195,0.3356706795490336,0.8894686687122495,0.800848785001453,0.4159615580522173,0.7455470326463328,0.6645970608603958,0.3289718411874543,0.793163680775069,0.9536194748954991,0.578774002345264,0.3799075557949935,0.5838736995124602,0.2688961134017468,0.5623828299370605,0.2640402660796208,0.5759351119143893,0.2150312192692787,-0.9238795329814845,-0.7559985325174577,-0.3356706794740955,-0.3862195443234521,-0.5201587395422288,-0.3223894901454282,-0.5662809390591549,-0.6684217570144617,-0.5978407392800358,-0.3023817415562419,-0.7014616366103491,-0.9295799192458276,-0.295307537010359,-0.8097722388313109,-0.8160225301970181,-0.2765688832827075,-0.546870141047109,-0.2630176846037312,-0.2609778636550608,-0.7782870848951134,-0.7832272498749652,-0.3498167730230086,-0.5233357175213185,-0.3316093343070137,-0.5451052018852607,-0.7405266754788727,-0.9313728982106689,-0.7722030889413216,-0.4940078165487054,-0.4915633565828705,-0.5715454086367254,-0.2034338972476547,-0.2760763226009069,-0.3357061054504618,-0.9330513401685748,-0.2832883924474048,-0.6080832912598992,-0.26026462301163,-0.5566472929557854]}], "layout": {"template":{"layout":{"coloraxis":{"colorbar":{"ticks":"","outlinewidth":0}},"xaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"hovermode":"closest","paper_bgcolor":"white","geo":{"showlakes":true,"showland":true,"landcolor":"#E5ECF6","bgcolor":"white","subunitcolor":"white","lakecolor":"white"},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"yaxis":{"gridcolor":"white","zerolinewidth":2,"title":{"standoff":15},"ticks":"","zerolinecolor":"white","automargin":true,"linecolor":"white"},"shapedefaults":{"line":{"color":"#2a3f5f"}},"hoverlabel":{"align":"left"},"mapbox":{"style":"light"},"polar":{"angularaxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"autotypenumbers":"strict","font":{"color":"#2a3f5f"},"ternary":{"baxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","ticks":"","linecolor":"white"},"aaxis":{"gridcolor":"white","ticks":"","linecolor":"white"}},"annotationdefaults":{"arrowhead":0,"arrowwidth":1,"arrowcolor":"#2a3f5f"},"plot_bgcolor":"#E5ECF6","title":{"x":0.05},"scene":{"xaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"zaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"},"yaxis":{"gridcolor":"white","gridwidth":2,"backgroundcolor":"#E5ECF6","ticks":"","showbackground":true,"zerolinecolor":"white","linecolor":"white"}},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"]},"data":{"barpolar":[{"type":"barpolar","marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"carpet":[{"aaxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"},"type":"carpet","baxis":{"gridcolor":"white","endlinecolor":"#2a3f5f","minorgridcolor":"white","startlinecolor":"#2a3f5f","linecolor":"white"}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"parcoords":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"parcoords"}],"scatter":[{"type":"scatter","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2dcontour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2dcontour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contour","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"mesh3d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"mesh3d"}],"surface":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"surface","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram":[{"type":"histogram","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"pie":[{"type":"pie","automargin":true}],"choropleth":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"choropleth"}],"heatmapgl":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmapgl","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"bar":[{"type":"bar","error_y":{"color":"#2a3f5f"},"error_x":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5}}}],"heatmap":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"heatmap","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"contourcarpet"}],"table":[{"type":"table","header":{"line":{"color":"white"},"fill":{"color":"#C8D4E3"}},"cells":{"line":{"color":"white"},"fill":{"color":"#EBF0F8"}}}],"scatter3d":[{"line":{"colorbar":{"ticks":"","outlinewidth":0}},"type":"scatter3d","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"histogram2d":[{"colorbar":{"ticks":"","outlinewidth":0},"type":"histogram2d","colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"ticks":"","outlinewidth":0}}}]}},"margin":{"l":50,"b":50,"r":50,"t":60},"title":"PMCHWT j"}, "config": {"showLink":false,"editable":false,"responsive":true,"staticPlot":false,"scrollZoom":true}}
    Plotly.newPlot(PLOT, plot_obj)

    // If width is not specified, set it to 100%
    PLOT.style.width = plot_obj.layout.width ? "" : "100%"
    
    // For the height we have to also put a fixed value in case the plot is put on a non-fixed-size container (like the default wrapper)
    PLOT.style.height = plot_obj.layout.height ? "" : "100%"
</script>

```

---

*This page was generated using [Literate.jl](https://github.com/fredrikekre/Literate.jl).*

